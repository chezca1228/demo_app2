<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: RDoc::Markup::PreProcess</title>

  <link rel="stylesheet" href="../../rdoc.css" type="text/css" media="screen" />

  <script src="../../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../../index.html">Home</a>
          <a href="../../index.html#classes">Classes</a>
          <a href="../../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../../lib/rdoc/markup/pre_process_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/rdoc/markup/pre_process.rb">lib/rdoc/markup/pre_process.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link"><a href="../../Object.html">Object</a></p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-c-register">::register</a></li>
          
          <li><a href="#method-c-registered">::registered</a></li>
          
          <li><a href="#method-i-find_include_file">#find_include_file</a></li>
          
          <li><a href="#method-i-handle">#handle</a></li>
          
          <li><a href="#method-i-handle_directive">#handle_directive</a></li>
          
          <li><a href="#method-i-include_file">#include_file</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../../History_txt.html">History.txt</a></li>
        
          <li class="file"><a href="../../LICENSE_txt.html">LICENSE.txt</a></li>
        
          <li class="file"><a href="../../Manifest_txt.html">Manifest.txt</a></li>
        
          <li class="file"><a href="../../README_txt.html">README.txt</a></li>
        
          <li class="file"><a href="../../RI_txt.html">RI.txt</a></li>
        
          <li class="file"><a href="../../Rakefile.html">Rakefile</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../../RDoc.html">RDoc</a></li>
        
          <li><a href="../../RDoc/Alias.html">RDoc::Alias</a></li>
        
          <li><a href="../../RDoc/AnonClass.html">RDoc::AnonClass</a></li>
        
          <li><a href="../../RDoc/AnyMethod.html">RDoc::AnyMethod</a></li>
        
          <li><a href="../../RDoc/Attr.html">RDoc::Attr</a></li>
        
          <li><a href="../../RDoc/ClassModule.html">RDoc::ClassModule</a></li>
        
          <li><a href="../../RDoc/CodeObject.html">RDoc::CodeObject</a></li>
        
          <li><a href="../../RDoc/Constant.html">RDoc::Constant</a></li>
        
          <li><a href="../../RDoc/Context.html">RDoc::Context</a></li>
        
          <li><a href="../../RDoc/Context/Section.html">RDoc::Context::Section</a></li>
        
          <li><a href="../../RDoc/CrossReference.html">RDoc::CrossReference</a></li>
        
          <li><a href="../../RDoc/ERBIO.html">RDoc::ERBIO</a></li>
        
          <li><a href="../../RDoc/Encoding.html">RDoc::Encoding</a></li>
        
          <li><a href="../../RDoc/Error.html">RDoc::Error</a></li>
        
          <li><a href="../../RDoc/Gauntlet.html">RDoc::Gauntlet</a></li>
        
          <li><a href="../../RDoc/Generator.html">RDoc::Generator</a></li>
        
          <li><a href="../../RDoc/Generator/Darkfish.html">RDoc::Generator::Darkfish</a></li>
        
          <li><a href="../../RDoc/Generator/Markup.html">RDoc::Generator::Markup</a></li>
        
          <li><a href="../../RDoc/Generator/RI.html">RDoc::Generator::RI</a></li>
        
          <li><a href="../../RDoc/GhostMethod.html">RDoc::GhostMethod</a></li>
        
          <li><a href="../../RDoc/Include.html">RDoc::Include</a></li>
        
          <li><a href="../../RDoc/Markup.html">RDoc::Markup</a></li>
        
          <li><a href="../../RDoc/Markup/AttrChanger.html">RDoc::Markup::AttrChanger</a></li>
        
          <li><a href="../../RDoc/Markup/AttrSpan.html">RDoc::Markup::AttrSpan</a></li>
        
          <li><a href="../../RDoc/Markup/Attribute.html">RDoc::Markup::Attribute</a></li>
        
          <li><a href="../../RDoc/Markup/AttributeManager.html">RDoc::Markup::AttributeManager</a></li>
        
          <li><a href="../../RDoc/Markup/BlankLine.html">RDoc::Markup::BlankLine</a></li>
        
          <li><a href="../../RDoc/Markup/Document.html">RDoc::Markup::Document</a></li>
        
          <li><a href="../../RDoc/Markup/Formatter.html">RDoc::Markup::Formatter</a></li>
        
          <li><a href="../../RDoc/Markup/FormatterTestCase.html">RDoc::Markup::FormatterTestCase</a></li>
        
          <li><a href="../../RDoc/Markup/Heading.html">RDoc::Markup::Heading</a></li>
        
          <li><a href="../../RDoc/Markup/IndentedParagraph.html">RDoc::Markup::IndentedParagraph</a></li>
        
          <li><a href="../../RDoc/Markup/List.html">RDoc::Markup::List</a></li>
        
          <li><a href="../../RDoc/Markup/ListItem.html">RDoc::Markup::ListItem</a></li>
        
          <li><a href="../../RDoc/Markup/Paragraph.html">RDoc::Markup::Paragraph</a></li>
        
          <li><a href="../../RDoc/Markup/Parser.html">RDoc::Markup::Parser</a></li>
        
          <li><a href="../../RDoc/Markup/Parser/Error.html">RDoc::Markup::Parser::Error</a></li>
        
          <li><a href="../../RDoc/Markup/Parser/ParseError.html">RDoc::Markup::Parser::ParseError</a></li>
        
          <li><a href="../../RDoc/Markup/PreProcess.html">RDoc::Markup::PreProcess</a></li>
        
          <li><a href="../../RDoc/Markup/Raw.html">RDoc::Markup::Raw</a></li>
        
          <li><a href="../../RDoc/Markup/Rule.html">RDoc::Markup::Rule</a></li>
        
          <li><a href="../../RDoc/Markup/Special.html">RDoc::Markup::Special</a></li>
        
          <li><a href="../../RDoc/Markup/TextFormatterTestCase.html">RDoc::Markup::TextFormatterTestCase</a></li>
        
          <li><a href="../../RDoc/Markup/ToAnsi.html">RDoc::Markup::ToAnsi</a></li>
        
          <li><a href="../../RDoc/Markup/ToBs.html">RDoc::Markup::ToBs</a></li>
        
          <li><a href="../../RDoc/Markup/ToHtml.html">RDoc::Markup::ToHtml</a></li>
        
          <li><a href="../../RDoc/Markup/ToHtmlCrossref.html">RDoc::Markup::ToHtmlCrossref</a></li>
        
          <li><a href="../../RDoc/Markup/ToRdoc.html">RDoc::Markup::ToRdoc</a></li>
        
          <li><a href="../../RDoc/Markup/ToTest.html">RDoc::Markup::ToTest</a></li>
        
          <li><a href="../../RDoc/Markup/ToTtOnly.html">RDoc::Markup::ToTtOnly</a></li>
        
          <li><a href="../../RDoc/Markup/Verbatim.html">RDoc::Markup::Verbatim</a></li>
        
          <li><a href="../../RDoc/MetaMethod.html">RDoc::MetaMethod</a></li>
        
          <li><a href="../../RDoc/MethodAttr.html">RDoc::MethodAttr</a></li>
        
          <li><a href="../../RDoc/NormalClass.html">RDoc::NormalClass</a></li>
        
          <li><a href="../../RDoc/NormalModule.html">RDoc::NormalModule</a></li>
        
          <li><a href="../../RDoc/Options.html">RDoc::Options</a></li>
        
          <li><a href="../../RDoc/Parser.html">RDoc::Parser</a></li>
        
          <li><a href="../../RDoc/Parser/C.html">RDoc::Parser::C</a></li>
        
          <li><a href="../../RDoc/Parser/Ruby.html">RDoc::Parser::Ruby</a></li>
        
          <li><a href="../../RDoc/Parser/RubyTools.html">RDoc::Parser::RubyTools</a></li>
        
          <li><a href="../../RDoc/Parser/Simple.html">RDoc::Parser::Simple</a></li>
        
          <li><a href="../../RDoc/RDoc.html">RDoc::RDoc</a></li>
        
          <li><a href="../../RDoc/RI.html">RDoc::RI</a></li>
        
          <li><a href="../../RDoc/RI/Driver.html">RDoc::RI::Driver</a></li>
        
          <li><a href="../../RDoc/RI/Driver/Error.html">RDoc::RI::Driver::Error</a></li>
        
          <li><a href="../../RDoc/RI/Driver/NotFoundError.html">RDoc::RI::Driver::NotFoundError</a></li>
        
          <li><a href="../../RDoc/RI/Error.html">RDoc::RI::Error</a></li>
        
          <li><a href="../../RDoc/RI/Paths.html">RDoc::RI::Paths</a></li>
        
          <li><a href="../../RDoc/RI/Store.html">RDoc::RI::Store</a></li>
        
          <li><a href="../../RDoc/Require.html">RDoc::Require</a></li>
        
          <li><a href="../../RDoc/RubyLex.html">RDoc::RubyLex</a></li>
        
          <li><a href="../../RDoc/RubyToken.html">RDoc::RubyToken</a></li>
        
          <li><a href="../../RDoc/RubygemsHook.html">RDoc::RubygemsHook</a></li>
        
          <li><a href="../../RDoc/SingleClass.html">RDoc::SingleClass</a></li>
        
          <li><a href="../../RDoc/Stats.html">RDoc::Stats</a></li>
        
          <li><a href="../../RDoc/Stats/Normal.html">RDoc::Stats::Normal</a></li>
        
          <li><a href="../../RDoc/Stats/Quiet.html">RDoc::Stats::Quiet</a></li>
        
          <li><a href="../../RDoc/Stats/Verbose.html">RDoc::Stats::Verbose</a></li>
        
          <li><a href="../../RDoc/Task.html">RDoc::Task</a></li>
        
          <li><a href="../../RDoc/Task.html">RDoc::Task</a></li>
        
          <li><a href="../../RDoc/Text.html">RDoc::Text</a></li>
        
          <li><a href="../../RDoc/TokenStream.html">RDoc::TokenStream</a></li>
        
          <li><a href="../../RDoc/TopLevel.html">RDoc::TopLevel</a></li>
        
          <li><a href="../../Object.html">Object</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">RDoc::Markup::PreProcess</h1>

    <div id="description" class="description">
      
<p>Handle common directives that can occur in a block of text:</p>

<pre>:include: filename</pre>

<p>Directives can be escaped by preceding them with a backslash.</p>

<p><a href="../RDoc.html">RDoc</a> plugin authors can register additional
directives to be handled by using <a
href="PreProcess.html#method-c-register">RDoc::Markup::PreProcess::register</a></p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      
      <!-- Attributes -->
      <div id="attribute-method-details" class="method-section section">
        <h3 class="section-header">Attributes</h3>

        
        <div id="options-attribute-method" class="method-detail">
          <a name="options"></a>
          
          <a name="options="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">options</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description">
          
          
          
          </div>
        </div>
        
      </div><!-- attribute-method-details -->
      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">(input_file_name, include_path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Creates a new pre-processor for <tt>input_file_name</tt> that will look for
included files in <tt>include_path</tt></p>
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File lib/rdoc/markup/pre_process.rb, line 40</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">input_file_name</span>, <span class="ruby-identifier">include_path</span>)
  <span class="ruby-ivar">@input_file_name</span> = <span class="ruby-identifier">input_file_name</span>
  <span class="ruby-ivar">@include_path</span> = <span class="ruby-identifier">include_path</span>
  <span class="ruby-ivar">@options</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
        <div id="register-method" class="method-detail ">
          <a name="method-c-register"></a>

          
          <div class="method-heading">
            <span class="method-name">register</span><span
              class="method-args">(directive, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Registers <tt>directive</tt> as one handled by <a
href="../RDoc.html">RDoc</a>.  If a block is given the directive will be
replaced by the result of the block, otherwise the directive will be
removed from the processed text.</p>
            

            
            <div class="method-source-code" id="register-source">
<pre>
<span class="ruby-comment"># File lib/rdoc/markup/pre_process.rb, line 25</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">register</span> <span class="ruby-identifier">directive</span>, &amp;<span class="ruby-identifier">block</span>
  <span class="ruby-ivar">@registered</span>[<span class="ruby-identifier">directive</span>] = <span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- register-source -->
            
          </div>

          

          
        </div><!-- register-method -->

      
        <div id="registered-method" class="method-detail ">
          <a name="method-c-registered"></a>

          
          <div class="method-heading">
            <span class="method-name">registered</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Registered directives</p>
            

            
            <div class="method-source-code" id="registered-source">
<pre>
<span class="ruby-comment"># File lib/rdoc/markup/pre_process.rb, line 32</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">registered</span>
  <span class="ruby-ivar">@registered</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- registered-source -->
            
          </div>

          

          
        </div><!-- registered-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="find_include_file-method" class="method-detail ">
          <a name="method-i-find_include_file"></a>

          
          <div class="method-heading">
            <span class="method-name">find_include_file</span><span
              class="method-args">(name)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Look for the given file in the directory containing the current file, and
then in each of the directories specified in the RDOC_INCLUDE path</p>
            

            
            <div class="method-source-code" id="find_include_file-source">
<pre>
<span class="ruby-comment"># File lib/rdoc/markup/pre_process.rb, line 216</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_include_file</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-identifier">to_search</span> = [<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-ivar">@input_file_name</span>)].<span class="ruby-identifier">concat</span> <span class="ruby-ivar">@include_path</span>
  <span class="ruby-identifier">to_search</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dir</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">full_name</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">name</span>)
    <span class="ruby-identifier">stat</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">full_name</span>) <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">next</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">full_name</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">readable?</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- find_include_file-source -->
            
          </div>

          

          
        </div><!-- find_include_file-method -->

      
        <div id="handle-method" class="method-detail ">
          <a name="method-i-handle"></a>

          
          <div class="method-heading">
            <span class="method-name">handle</span><span
              class="method-args">(text, code_object = nil, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Look for directives in a chunk of <tt>text</tt>.</p>

<p><a href="../Options.html">Options</a> that we don't handle are yielded.  If
the block returns false the directive is restored to the text.  If the
block returns nil or no block was given the directive is handled according
to the registered directives. If a String was returned the directive is
replaced with the string.</p>

<p>If no matching directive was registered the directive is restored to the
text.</p>

<p>If <tt>code_object</tt> is given and the param is set as metadata on the
<tt>code_object</tt>.  See <a
href="../CodeObject.html#attribute-i-metadata">RDoc::CodeObject#metadata</a></p>
            

            
            <div class="method-source-code" id="handle-source">
<pre>
<span class="ruby-comment"># File lib/rdoc/markup/pre_process.rb, line 60</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">handle</span> <span class="ruby-identifier">text</span>, <span class="ruby-identifier">code_object</span> = <span class="ruby-keyword">nil</span>, &amp;<span class="ruby-identifier">block</span>
  <span class="ruby-identifier">encoding</span> = <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-constant">Encoding</span>) <span class="ruby-keyword">then</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">encoding</span> <span class="ruby-keyword">else</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># regexp helper (square brackets for optional)</span>
  <span class="ruby-comment"># $1      $2  $3        $4      $5</span>
  <span class="ruby-comment"># [prefix][\]:directive:[spaces][param]newline</span>
  <span class="ruby-identifier">text</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-node">/^([ \t]*(?:#|\/?\*)?[ \t]*)(\\?):(\w+):([ \t]*)(.+)?\n/</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-comment"># skip something like ':toto::'</span>
    <span class="ruby-keyword">next</span> <span class="ruby-node">$&amp;</span> <span class="ruby-keyword">if</span> <span class="ruby-node">$4</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword">and</span> <span class="ruby-node">$5</span> <span class="ruby-keyword">and</span> <span class="ruby-node">$5</span>[<span class="ruby-value">0</span>, <span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">':'</span>

    <span class="ruby-comment"># skip if escaped</span>
    <span class="ruby-keyword">next</span> <span class="ruby-node">&quot;#$1:#$3:#$4#$5\n&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-node">$2</span>.<span class="ruby-identifier">empty?</span>

    <span class="ruby-identifier">handle_directive</span> <span class="ruby-node">$1</span>, <span class="ruby-node">$3</span>, <span class="ruby-node">$5</span>, <span class="ruby-identifier">code_object</span>, <span class="ruby-identifier">encoding</span>, &amp;<span class="ruby-identifier">block</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">text</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- handle-source -->
            
          </div>

          

          
        </div><!-- handle-method -->

      
        <div id="handle_directive-method" class="method-detail ">
          <a name="method-i-handle_directive"></a>

          
          <div class="method-heading">
            <span class="method-name">handle_directive</span><span
              class="method-args">(prefix, directive, param, code_object = nil, encoding = nil)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="handle_directive-source">
<pre>
<span class="ruby-comment"># File lib/rdoc/markup/pre_process.rb, line 81</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">handle_directive</span> <span class="ruby-identifier">prefix</span>, <span class="ruby-identifier">directive</span>, <span class="ruby-identifier">param</span>, <span class="ruby-identifier">code_object</span> = <span class="ruby-keyword">nil</span>,
                     <span class="ruby-identifier">encoding</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">blankline</span> = <span class="ruby-node">&quot;#{prefix.strip}\n&quot;</span>
  <span class="ruby-identifier">directive</span> = <span class="ruby-identifier">directive</span>.<span class="ruby-identifier">downcase</span>

  <span class="ruby-keyword">case</span> <span class="ruby-identifier">directive</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">'arg'</span>, <span class="ruby-string">'args'</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span>

    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">params</span> = <span class="ruby-identifier">param</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">'category'</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">if</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Context</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">code_object</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">section</span> = <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">add_section</span> <span class="ruby-identifier">param</span>, <span class="ruby-string">''</span>
      <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">temporary_section</span> = <span class="ruby-identifier">section</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">blankline</span> <span class="ruby-comment"># ignore category if we're not on an RDoc::Context</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">'doc'</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">document_self</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">force_documentation</span> = <span class="ruby-keyword">true</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">'enddoc'</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">done_documenting</span> = <span class="ruby-keyword">true</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">'include'</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">filename</span> = <span class="ruby-identifier">param</span>.<span class="ruby-identifier">split</span>.<span class="ruby-identifier">first</span>
    <span class="ruby-identifier">include_file</span> <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">prefix</span>, <span class="ruby-identifier">encoding</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">'main'</span> <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">main_page</span> = <span class="ruby-identifier">param</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:main_page</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">'nodoc'</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">document_self</span> = <span class="ruby-keyword">nil</span> <span class="ruby-comment"># notify nodoc</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">document_children</span> = <span class="ruby-identifier">param</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp">/all/</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">'notnew'</span>, <span class="ruby-string">'not_new'</span>, <span class="ruby-string">'not-new'</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">AnyMethod</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">code_object</span>

    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">dont_rename_initialize</span> = <span class="ruby-keyword">true</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">'startdoc'</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span>

    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">start_doc</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">force_documentation</span> = <span class="ruby-keyword">true</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">'stopdoc'</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span>

    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">stop_doc</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">'title'</span> <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">default_title</span> = <span class="ruby-identifier">param</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:default_title=</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">'yield'</span>, <span class="ruby-string">'yields'</span> <span class="ruby-keyword">then</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">blankline</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">code_object</span>
    <span class="ruby-comment"># remove parameter &amp;block</span>
    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">params</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-regexp">/,?\s*&amp;\w+/</span>, <span class="ruby-string">''</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">params</span>

    <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">block_params</span> = <span class="ruby-identifier">param</span>

    <span class="ruby-identifier">blankline</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">result</span> = <span class="ruby-keyword">yield</span> <span class="ruby-identifier">directive</span>, <span class="ruby-identifier">param</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>

    <span class="ruby-keyword">case</span> <span class="ruby-identifier">result</span>
    <span class="ruby-keyword">when</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">code_object</span>.<span class="ruby-identifier">metadata</span>[<span class="ruby-identifier">directive</span>] = <span class="ruby-identifier">param</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">code_object</span>

      <span class="ruby-keyword">if</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Markup</span><span class="ruby-operator">::</span><span class="ruby-constant">PreProcess</span>.<span class="ruby-identifier">registered</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">directive</span> <span class="ruby-keyword">then</span>
        <span class="ruby-identifier">handler</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Markup</span><span class="ruby-operator">::</span><span class="ruby-constant">PreProcess</span>.<span class="ruby-identifier">registered</span>[<span class="ruby-identifier">directive</span>]
        <span class="ruby-identifier">result</span> = <span class="ruby-identifier">handler</span>.<span class="ruby-identifier">call</span> <span class="ruby-identifier">directive</span>, <span class="ruby-identifier">param</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">handler</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">result</span> = <span class="ruby-node">&quot;#{prefix}:#{directive}: #{param}\n&quot;</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">when</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">result</span> = <span class="ruby-node">&quot;#{prefix}:#{directive}: #{param}\n&quot;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">result</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- handle_directive-source -->
            
          </div>

          

          
        </div><!-- handle_directive-method -->

      
        <div id="include_file-method" class="method-detail ">
          <a name="method-i-include_file"></a>

          
          <div class="method-heading">
            <span class="method-name">include_file</span><span
              class="method-args">(name, indent, encoding)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Handles the <tt>:include: <em>filename</em></tt> directive.</p>

<p>If the first line of the included file starts with ‘#’, and contains an
encoding information in the form ‘coding:’ or ‘coding=’, it is removed.</p>

<p>If all lines in the included file start with a ‘#’, this leading ‘#’ is
removed before inclusion. The included content is indented like the
<tt>:include:</tt> directive.</p>
            

            
            <div class="method-source-code" id="include_file-source">
<pre>
<span class="ruby-comment"># File lib/rdoc/markup/pre_process.rb, line 191</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">include_file</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">indent</span>, <span class="ruby-identifier">encoding</span>
  <span class="ruby-identifier">full_name</span> = <span class="ruby-identifier">find_include_file</span> <span class="ruby-identifier">name</span>

  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">full_name</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;Couldn't find file to include '#{name}' from #{@input_file_name}&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-string">''</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">content</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">read_file</span> <span class="ruby-identifier">full_name</span>, <span class="ruby-identifier">encoding</span>, <span class="ruby-keyword">true</span>

  <span class="ruby-comment"># strip magic comment</span>
  <span class="ruby-identifier">content</span> = <span class="ruby-identifier">content</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-node">/\A# .*coding[=:].*$/</span>, <span class="ruby-string">''</span>).<span class="ruby-identifier">lstrip</span>

  <span class="ruby-comment"># strip leading '#'s, but only if all lines start with them</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">content</span> <span class="ruby-operator">=~</span> <span class="ruby-node">/^[^#]/</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">content</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/^/</span>, <span class="ruby-identifier">indent</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">content</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-node">/^#?/</span>, <span class="ruby-identifier">indent</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- include_file-source -->
            
          </div>

          

          
        </div><!-- include_file-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

