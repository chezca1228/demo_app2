<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: Addressable::URI</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/addressable/uri_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/addressable/uri.rb">lib/addressable/uri.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      
      <!-- Namespace Contents -->
      <div id="namespace-list-section" class="section">
        <h3 class="section-header">Namespace</h3>
        <ul class="link-list">
          
          <li><span class="type">MODULE</span> <a href="URI/CharacterClasses.html">Addressable::URI::CharacterClasses</a></li>
          
          <li><span class="type">CLASS</span> <a href="URI/InvalidURIError.html">Addressable::URI::InvalidURIError</a></li>
          
        </ul>
      </div>
      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-convert_path">::convert_path</a></li>
          
          <li><a href="#method-c-encode">::encode</a></li>
          
          <li><a href="#method-c-encode_component">::encode_component</a></li>
          
          <li><a href="#method-c-escape">::escape</a></li>
          
          <li><a href="#method-c-form_encode">::form_encode</a></li>
          
          <li><a href="#method-c-form_unencode">::form_unencode</a></li>
          
          <li><a href="#method-c-heuristic_parse">::heuristic_parse</a></li>
          
          <li><a href="#method-c-ip_based_schemes">::ip_based_schemes</a></li>
          
          <li><a href="#method-c-join">::join</a></li>
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-c-normalize_component">::normalize_component</a></li>
          
          <li><a href="#method-c-normalized_encode">::normalized_encode</a></li>
          
          <li><a href="#method-c-parse">::parse</a></li>
          
          <li><a href="#method-c-port_mapping">::port_mapping</a></li>
          
          <li><a href="#method-c-unencode">::unencode</a></li>
          
          <li><a href="#method-c-unencode_component">::unencode_component</a></li>
          
          <li><a href="#method-c-unescape">::unescape</a></li>
          
          <li><a href="#method-c-unescape_component">::unescape_component</a></li>
          
          <li><a href="#method-i-2B">#+</a></li>
          
          <li><a href="#method-i-3D-3D">#==</a></li>
          
          <li><a href="#method-i-3D-3D-3D">#===</a></li>
          
          <li><a href="#method-i-absolute-3F">#absolute?</a></li>
          
          <li><a href="#method-i-authority">#authority</a></li>
          
          <li><a href="#method-i-authority-3D">#authority=</a></li>
          
          <li><a href="#method-i-basename">#basename</a></li>
          
          <li><a href="#method-i-defer_validation">#defer_validation</a></li>
          
          <li><a href="#method-i-display_uri">#display_uri</a></li>
          
          <li><a href="#method-i-dup">#dup</a></li>
          
          <li><a href="#method-i-eql-3F">#eql?</a></li>
          
          <li><a href="#method-i-extname">#extname</a></li>
          
          <li><a href="#method-i-fragment">#fragment</a></li>
          
          <li><a href="#method-i-fragment-3D">#fragment=</a></li>
          
          <li><a href="#method-i-freeze">#freeze</a></li>
          
          <li><a href="#method-i-hash">#hash</a></li>
          
          <li><a href="#method-i-host">#host</a></li>
          
          <li><a href="#method-i-host-3D">#host=</a></li>
          
          <li><a href="#method-i-inferred_port">#inferred_port</a></li>
          
          <li><a href="#method-i-inspect">#inspect</a></li>
          
          <li><a href="#method-i-ip_based-3F">#ip_based?</a></li>
          
          <li><a href="#method-i-join">#join</a></li>
          
          <li><a href="#method-i-join-21">#join!</a></li>
          
          <li><a href="#method-i-merge">#merge</a></li>
          
          <li><a href="#method-i-merge-21">#merge!</a></li>
          
          <li><a href="#method-i-normalize">#normalize</a></li>
          
          <li><a href="#method-i-normalize-21">#normalize!</a></li>
          
          <li><a href="#method-i-normalized_authority">#normalized_authority</a></li>
          
          <li><a href="#method-i-normalized_fragment">#normalized_fragment</a></li>
          
          <li><a href="#method-i-normalized_host">#normalized_host</a></li>
          
          <li><a href="#method-i-normalized_password">#normalized_password</a></li>
          
          <li><a href="#method-i-normalized_path">#normalized_path</a></li>
          
          <li><a href="#method-i-normalized_port">#normalized_port</a></li>
          
          <li><a href="#method-i-normalized_query">#normalized_query</a></li>
          
          <li><a href="#method-i-normalized_scheme">#normalized_scheme</a></li>
          
          <li><a href="#method-i-normalized_site">#normalized_site</a></li>
          
          <li><a href="#method-i-normalized_user">#normalized_user</a></li>
          
          <li><a href="#method-i-normalized_userinfo">#normalized_userinfo</a></li>
          
          <li><a href="#method-i-omit">#omit</a></li>
          
          <li><a href="#method-i-omit-21">#omit!</a></li>
          
          <li><a href="#method-i-origin">#origin</a></li>
          
          <li><a href="#method-i-password">#password</a></li>
          
          <li><a href="#method-i-password-3D">#password=</a></li>
          
          <li><a href="#method-i-path">#path</a></li>
          
          <li><a href="#method-i-path-3D">#path=</a></li>
          
          <li><a href="#method-i-port">#port</a></li>
          
          <li><a href="#method-i-port-3D">#port=</a></li>
          
          <li><a href="#method-i-query">#query</a></li>
          
          <li><a href="#method-i-query-3D">#query=</a></li>
          
          <li><a href="#method-i-query_values">#query_values</a></li>
          
          <li><a href="#method-i-query_values-3D">#query_values=</a></li>
          
          <li><a href="#method-i-relative-3F">#relative?</a></li>
          
          <li><a href="#method-i-request_uri">#request_uri</a></li>
          
          <li><a href="#method-i-request_uri-3D">#request_uri=</a></li>
          
          <li><a href="#method-i-route_from">#route_from</a></li>
          
          <li><a href="#method-i-route_to">#route_to</a></li>
          
          <li><a href="#method-i-scheme">#scheme</a></li>
          
          <li><a href="#method-i-scheme-3D">#scheme=</a></li>
          
          <li><a href="#method-i-site">#site</a></li>
          
          <li><a href="#method-i-site-3D">#site=</a></li>
          
          <li><a href="#method-i-to_hash">#to_hash</a></li>
          
          <li><a href="#method-i-to_s">#to_s</a></li>
          
          <li><a href="#method-i-to_str">#to_str</a></li>
          
          <li><a href="#method-i-user">#user</a></li>
          
          <li><a href="#method-i-user-3D">#user=</a></li>
          
          <li><a href="#method-i-userinfo">#userinfo</a></li>
          
          <li><a href="#method-i-userinfo-3D">#userinfo=</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../Addressable.html">Addressable</a></li>
        
          <li><a href="../Addressable/IDNA.html">Addressable::IDNA</a></li>
        
          <li><a href="../Addressable/IDNA/PunycodeBadInput.html">Addressable::IDNA::PunycodeBadInput</a></li>
        
          <li><a href="../Addressable/IDNA/PunycodeBigOutput.html">Addressable::IDNA::PunycodeBigOutput</a></li>
        
          <li><a href="../Addressable/IDNA/PunycodeOverflow.html">Addressable::IDNA::PunycodeOverflow</a></li>
        
          <li><a href="../Addressable/Template.html">Addressable::Template</a></li>
        
          <li><a href="../Addressable/Template/InvalidTemplateOperatorError.html">Addressable::Template::InvalidTemplateOperatorError</a></li>
        
          <li><a href="../Addressable/Template/InvalidTemplateValueError.html">Addressable::Template::InvalidTemplateValueError</a></li>
        
          <li><a href="../Addressable/Template/MatchData.html">Addressable::Template::MatchData</a></li>
        
          <li><a href="../Addressable/Template/TemplateOperatorAbortedError.html">Addressable::Template::TemplateOperatorAbortedError</a></li>
        
          <li><a href="../Addressable/URI.html">Addressable::URI</a></li>
        
          <li><a href="../Addressable/URI/CharacterClasses.html">Addressable::URI::CharacterClasses</a></li>
        
          <li><a href="../Addressable/URI/InvalidURIError.html">Addressable::URI::InvalidURIError</a></li>
        
          <li><a href="../Addressable/VERSION.html">Addressable::VERSION</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">Addressable::URI</h1>

    <div id="description" class="description">
      
<p>This is an implementation of a <a href="URI.html">URI</a> parser based on
&lt;a href=“<a
href="http://www.ietf.org/rfc/rfc3986.txt">RFC”>www.ietf.org/rfc/rfc3986.txt“>RFC</a>
3986&lt;/a&gt;, &lt;a href=”<a
href="http://www.ietf.org/rfc/rfc3987.txt">RFC“>www.ietf.org/rfc/rfc3987.txt”>RFC</a>
3987&lt;/a&gt;.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      
      <!-- Constants -->
      <div id="constants-list" class="section">
        <h3 class="section-header">Constants</h3>
        <dl>
        
          <dt><a name="EMPTYSTR">EMPTYSTR</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="NORMPATH">NORMPATH</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="NPATH1">NPATH1</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="NPATH2">NPATH2</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="NPATH3">NPATH3</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="NPATH4">NPATH4</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="PARENT1">PARENT1</a></dt>
          
          <dd class="description"><p>Resolves paths to their simplest form.</p>

<p>@param [String] path The path to normalize.</p>

<p>@return [String] The normalized path.</p></dd>
          
        
          <dt><a name="PARENT2">PARENT2</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="PORT_MAPPING">PORT_MAPPING</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="SLASH">SLASH</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="URIREGEX">URIREGEX</a></dt>
          
          <dd class="description"></dd>
          
        
        </dl>
      </div>
      

      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="convert_path-method" class="method-detail ">
          <a name="method-c-convert_path"></a>

          
          <div class="method-heading">
            <span class="method-name">convert_path</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Converts a path to a file scheme <a href="URI.html">URI</a>. If the path
supplied is relative, it will be returned as a relative <a
href="URI.html">URI</a>. If the path supplied is actually a non-file <a
href="URI.html">URI</a>, it will parse the <a href="URI.html">URI</a> as if
it had been parsed with <tt>Addressable::URI.parse</tt>. Handles all of the
various Microsoft-specific formats for specifying paths.</p>

<p>@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">to_str</a>] path</p>

<pre>Typically a &lt;code&gt;String&lt;/code&gt; path to a file or directory, but
will return a sensible return value if an absolute URI is supplied
instead.</pre>

<p>@return [Addressable::URI]</p>

<pre>The parsed file scheme URI or the original URI if some other URI
scheme was provided.</pre>

<p>@example</p>

<pre>base = Addressable::URI.convert_path(&quot;/absolute/path/&quot;)
uri = Addressable::URI.convert_path(&quot;relative/path&quot;)
(base + uri).to_s
#=&gt; &quot;file:///absolute/path/relative/path&quot;

Addressable::URI.convert_path(
  &quot;c:\\windows\\My Documents 100%20\\foo.txt&quot;
).to_s
#=&gt; &quot;file:///c:/windows/My%20Documents%20100%20/foo.txt&quot;

Addressable::URI.convert_path(&quot;http://example.com/&quot;).to_s
#=&gt; &quot;http://example.com/&quot;</pre>
            

            
            <div class="method-source-code" id="convert_path-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 228</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">convert_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-comment"># If we were given nil, return nil.</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">path</span>
  <span class="ruby-comment"># If a URI object is passed, just return itself.</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">path</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-keyword">self</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">path</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{path.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># Otherwise, convert to a String</span>
  <span class="ruby-identifier">path</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">to_str</span>.<span class="ruby-identifier">strip</span>

  <span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/^file:\/?\/?/</span>, <span class="ruby-constant">EMPTYSTR</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^file:\/?\/?/</span>
  <span class="ruby-identifier">path</span> = <span class="ruby-constant">SLASH</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">path</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^([a-zA-Z])[\|:]/</span>
  <span class="ruby-identifier">uri</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">path</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-comment"># Adjust windows-style uris</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/^\/?([a-zA-Z])[\|:][\\\/]/</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-node">&quot;/#{$1.downcase}:/&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/\\/</span>, <span class="ruby-constant">SLASH</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>) <span class="ruby-operator">&amp;&amp;</span>
        <span class="ruby-constant">File</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>).<span class="ruby-identifier">directory?</span>
      <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/\/$/</span>, <span class="ruby-constant">EMPTYSTR</span>)
      <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">+</span> <span class="ruby-string">'/'</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># If the path is absolute, set the scheme and host.</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^\//</span>
      <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span> = <span class="ruby-string">&quot;file&quot;</span>
      <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span> = <span class="ruby-constant">EMPTYSTR</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">normalize!</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">uri</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- convert_path-source -->
            
          </div>

          

          
        </div><!-- convert_path-method -->

      
        <div id="encode-method" class="method-detail ">
          <a name="method-c-encode"></a>

          
          <div class="method-heading">
            <span class="method-name">encode</span><span
              class="method-args">(uri, returning=String)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Percent encodes any special characters in the <a href="URI.html">URI</a>.</p>

<p>@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">to_str</a>] uri</p>

<pre>The URI to encode.</pre>

<p>@param [Class] returning</p>

<pre>The type of object to return.
This value may only be set to &lt;code&gt;String&lt;/code&gt; or
&lt;code&gt;Addressable::URI&lt;/code&gt;. All other values are invalid. Defaults
to &lt;code&gt;String&lt;/code&gt;.</pre>

<p>@return [String, Addressable::URI]</p>

<pre>The encoded URI.
The return type is determined by the &lt;code&gt;returning&lt;/code&gt; parameter.</pre>
            

            
            <div class="method-source-code" id="encode-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 485</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">returning</span>=<span class="ruby-constant">String</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>, <span class="ruby-constant">TypeError</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span>[<span class="ruby-constant">String</span>, <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">returning</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>,
      <span class="ruby-string">&quot;Expected Class (String or Addressable::URI), &quot;</span> <span class="ruby-operator">+</span>
      <span class="ruby-node">&quot;got #{returning.inspect}&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">uri_object</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-keyword">self</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>)
  <span class="ruby-identifier">encoded_uri</span> = <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(
    <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">scheme</span>,
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">SCHEME</span>),
    <span class="ruby-value">:authority</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">authority</span>,
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">AUTHORITY</span>),
    <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">path</span>,
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH</span>),
    <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">query</span>,
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">QUERY</span>),
    <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">fragment</span>,
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">FRAGMENT</span>)
  )
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">returning</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">encoded_uri</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">returning</span> <span class="ruby-operator">==</span> <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">encoded_uri</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- encode-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="URI.html#method-c-escape">escape</a>
          </div>
          

          
        </div><!-- encode-method -->

      
        <div id="encode_component-method" class="method-detail ">
          <a name="method-c-encode_component"></a>

          
          <div class="method-heading">
            <span class="method-name">encode_component</span><span
              class="method-args">(component, character_class= CharacterClasses::RESERVED + CharacterClasses::UNRESERVED)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Percent encodes a <a href="URI.html">URI</a> component.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>] component
The <a href="URI.html">URI</a> component to encode.</p>

<p>@param [String, Regexp] character_class</p>

<pre> The characters which are not percent encoded. If a &lt;code&gt;String&lt;/code&gt;
 is passed, the &lt;code&gt;String&lt;/code&gt; must be formatted as a regular
 expression character class. (Do not include the surrounding square
 brackets.)  For example, &lt;code&gt;&quot;b-zB-Z0-9&quot;&lt;/code&gt; would cause
 everything but the letters 'b' through 'z' and the numbers '0' through
'9' to be percent encoded. If a &lt;code&gt;Regexp&lt;/code&gt; is passed, the
 value &lt;code&gt;/[^b-zB-Z0-9]/&lt;/code&gt; would have the same effect. A set of
 useful &lt;code&gt;String&lt;/code&gt; values may be found in the
 &lt;code&gt;Addressable::URI::CharacterClasses&lt;/code&gt; module. The default
 value is the reserved plus unreserved character classes specified in
 &lt;a href=&quot;http://www.ietf.org/rfc/rfc3986.txt&quot;&gt;RFC 3986&lt;/a&gt;.</pre>

<p>@return [String] The encoded component.</p>

<p>@example</p>

<pre>Addressable::URI.encode_component(&quot;simple/example&quot;, &quot;b-zB-Z0-9&quot;)
=&gt; &quot;simple%2Fex%61mple&quot;
Addressable::URI.encode_component(&quot;simple/example&quot;, /[^b-zB-Z0-9]/)
=&gt; &quot;simple%2Fex%61mple&quot;
Addressable::URI.encode_component(
  &quot;simple/example&quot;, Addressable::URI::CharacterClasses::UNRESERVED
)
=&gt; &quot;simple%2Fexample&quot;</pre>
            

            
            <div class="method-source-code" id="encode_component-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 322</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">component</span>, <span class="ruby-identifier">character_class</span>=
    <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">RESERVED</span> <span class="ruby-operator">+</span> <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">component</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">component</span> = <span class="ruby-identifier">component</span>.<span class="ruby-identifier">to_str</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-constant">NoMethodError</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{component.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">component</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span>[<span class="ruby-constant">String</span>, <span class="ruby-constant">Regexp</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">character_class</span>.<span class="ruby-identifier">class</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>,
      <span class="ruby-node">&quot;Expected String or Regexp, got #{character_class.inspect}&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">character_class</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">String</span>)
    <span class="ruby-identifier">character_class</span> = <span class="ruby-node">/[^#{character_class}]/</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">component</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:force_encoding</span>)
    <span class="ruby-comment"># We can't perform regexps on invalid UTF sequences, but</span>
    <span class="ruby-comment"># here we need to, so switch to ASCII.</span>
    <span class="ruby-identifier">component</span> = <span class="ruby-identifier">component</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-identifier">component</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-constant">Encoding</span><span class="ruby-operator">::</span><span class="ruby-constant">ASCII_8BIT</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">component</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-identifier">character_class</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sequence</span><span class="ruby-operator">|</span>
    (<span class="ruby-identifier">sequence</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-string">'C*'</span>).<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-string">&quot;%&quot;</span> <span class="ruby-operator">+</span> (<span class="ruby-string">&quot;%02x&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">c</span>).<span class="ruby-identifier">upcase</span> }).<span class="ruby-identifier">join</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- encode_component-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: encode_component
          </div>
          

          
        </div><!-- encode_component-method -->

      
        <div id="escape-method" class="method-detail method-alias">
          <a name="method-c-escape"></a>

          
          <div class="method-heading">
            <span class="method-name">escape</span><span
              class="method-args">(uri, returning=String)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="URI.html#method-c-encode">encode</a>
          </div>
          
        </div><!-- escape-method -->

      
        <div id="form_encode-method" class="method-detail ">
          <a name="method-c-form_encode"></a>

          
          <div class="method-heading">
            <span class="method-name">form_encode</span><span
              class="method-args">(form_values, sort=false)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Encodes a set of key/value pairs according to the rules for the
<tt>application/x-www-form-urlencoded</tt> MIME type.</p>

<p>@param [<a href="URI.html#method-i-to_hash">to_hash</a>, to_ary]
form_values</p>

<pre>The form values to encode.</pre>

<p>@param [TrueClass, FalseClass] sort</p>

<pre>Sort the key/value pairs prior to encoding.
Defaults to &lt;code&gt;false&lt;/code&gt;.</pre>

<p>@return [String]</p>

<pre>The encoded value.</pre>
            

            
            <div class="method-source-code" id="form_encode-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 609</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">form_encode</span>(<span class="ruby-identifier">form_values</span>, <span class="ruby-identifier">sort</span>=<span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_hash</span>)
    <span class="ruby-identifier">form_values</span> = <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">to_hash</span>.<span class="ruby-identifier">to_a</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_ary</span>)
    <span class="ruby-identifier">form_values</span> = <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">to_ary</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{form_values.class} into Array.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">form_values</span> = <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
    [<span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">sort</span>
    <span class="ruby-comment"># Useful for OAuth and optimizing caching systems</span>
    <span class="ruby-identifier">form_values</span> = <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">sort</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">escaped_form_values</span> = <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
    <span class="ruby-comment"># Line breaks are CRLF pairs</span>
    [
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(
        <span class="ruby-identifier">key</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/(\r\n|\n|\r)/</span>, <span class="ruby-string">&quot;\r\n&quot;</span>),
        <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>
      ).<span class="ruby-identifier">gsub</span>(<span class="ruby-string">&quot;%20&quot;</span>, <span class="ruby-string">&quot;+&quot;</span>),
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(
        <span class="ruby-identifier">value</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/(\r\n|\n|\r)/</span>, <span class="ruby-string">&quot;\r\n&quot;</span>),
        <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>
      ).<span class="ruby-identifier">gsub</span>(<span class="ruby-string">&quot;%20&quot;</span>, <span class="ruby-string">&quot;+&quot;</span>)
    ]
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> (<span class="ruby-identifier">escaped_form_values</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
    <span class="ruby-node">&quot;#{key}=#{value}&quot;</span>
  <span class="ruby-keyword">end</span>).<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;&amp;&quot;</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- form_encode-source -->
            
          </div>

          

          
        </div><!-- form_encode-method -->

      
        <div id="form_unencode-method" class="method-detail ">
          <a name="method-c-form_unencode"></a>

          
          <div class="method-heading">
            <span class="method-name">form_unencode</span><span
              class="method-args">(encoded_value)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Decodes a <tt>String</tt> according to the rules for the
<tt>application/x-www-form-urlencoded</tt> MIME type.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>]
encoded_value</p>

<pre>The form values to decode.</pre>

<p>@return [Array]</p>

<pre>The decoded values.
This is not a &lt;code&gt;Hash&lt;/code&gt; because of the possibility for
duplicate keys.</pre>
            

            
            <div class="method-source-code" id="form_unencode-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 653</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">form_unencode</span>(<span class="ruby-identifier">encoded_value</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">encoded_value</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{encoded_value.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">encoded_value</span> = <span class="ruby-identifier">encoded_value</span>.<span class="ruby-identifier">to_str</span>
  <span class="ruby-identifier">split_values</span> = <span class="ruby-identifier">encoded_value</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;&amp;&quot;</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;=&quot;</span>, <span class="ruby-value">2</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">split_values</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
    [
      <span class="ruby-identifier">key</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unencode_component</span>(
        <span class="ruby-identifier">key</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-string">&quot;+&quot;</span>, <span class="ruby-string">&quot;%20&quot;</span>)).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/(\r\n|\n|\r)/</span>, <span class="ruby-string">&quot;\n&quot;</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>,
      <span class="ruby-identifier">value</span> <span class="ruby-operator">?</span> (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">unencode_component</span>(
        <span class="ruby-identifier">value</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-string">&quot;+&quot;</span>, <span class="ruby-string">&quot;%20&quot;</span>)).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/(\r\n|\n|\r)/</span>, <span class="ruby-string">&quot;\n&quot;</span>)) <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
    ]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- form_unencode-source -->
            
          </div>

          

          
        </div><!-- form_unencode-method -->

      
        <div id="heuristic_parse-method" class="method-detail ">
          <a name="method-c-heuristic_parse"></a>

          
          <div class="method-heading">
            <span class="method-name">heuristic_parse</span><span
              class="method-args">(uri, hints={})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Converts an input to a <a href="URI.html">URI</a>. The input does not have
to be a valid <a href="URI.html">URI</a> — the method will use heuristics
to guess what <a href="URI.html">URI</a> was intended. This is not
standards-compliant, merely user-friendly.</p>

<p>@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">to_str</a>] uri</p>

<pre>The URI string to parse.
No parsing is performed if the object is already an
&lt;code&gt;Addressable::URI&lt;/code&gt;.</pre>

<p>@param [Hash] hints</p>

<pre>A &lt;code&gt;Hash&lt;/code&gt; of hints to the heuristic parser.
Defaults to &lt;code&gt;{:scheme =&gt; &quot;http&quot;}&lt;/code&gt;.</pre>

<p>@return [Addressable::URI] The parsed <a href="URI.html">URI</a>.</p>
            

            
            <div class="method-source-code" id="heuristic_parse-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 155</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">heuristic_parse</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">hints</span>={})
  <span class="ruby-comment"># If we were given nil, return nil.</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">uri</span>
  <span class="ruby-comment"># If a URI object is passed, just return itself.</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">dup</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-keyword">self</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># Otherwise, convert to a String</span>
  <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">hints</span> = {
    <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;http&quot;</span>
  }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">hints</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">uri</span>
  <span class="ruby-keyword">when</span> <span class="ruby-regexp">/^http:\/+/</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/^http:\/+/</span>, <span class="ruby-string">&quot;http://&quot;</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-regexp">/^https:\/+/</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/^https:\/+/</span>, <span class="ruby-string">&quot;https://&quot;</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-regexp">/^feed:\/+http:\/+/</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/^feed:\/+http:\/+/</span>, <span class="ruby-string">&quot;feed:http://&quot;</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-regexp">/^feed:\/+/</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/^feed:\/+/</span>, <span class="ruby-string">&quot;feed://&quot;</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-regexp">/^file:\/+/</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/^file:\/+/</span>, <span class="ruby-string">&quot;file:///&quot;</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">parsed</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">=~</span> <span class="ruby-node">/^[^\/?#\.]+\.[^\/?#]+$/</span>
    <span class="ruby-identifier">parsed</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">hints</span>[<span class="ruby-value">:scheme</span>] <span class="ruby-operator">+</span> <span class="ruby-string">&quot;://&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;.&quot;</span>)
    <span class="ruby-identifier">new_host</span> = <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">path</span>[<span class="ruby-regexp">/^([^\/]+\.[^\/]*)/</span>, <span class="ruby-value">1</span>]
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_host</span>
      <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">defer_validation</span> <span class="ruby-keyword">do</span>
        <span class="ruby-identifier">new_path</span> = <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub</span>(
          <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;^&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-identifier">new_host</span>)), <span class="ruby-constant">EMPTYSTR</span>)
        <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">host</span> = <span class="ruby-identifier">new_host</span>
        <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">path</span> = <span class="ruby-identifier">new_path</span>
        <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">scheme</span> = <span class="ruby-identifier">hints</span>[<span class="ruby-value">:scheme</span>] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">scheme</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">parsed</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- heuristic_parse-source -->
            
          </div>

          

          
        </div><!-- heuristic_parse-method -->

      
        <div id="ip_based_schemes-method" class="method-detail ">
          <a name="method-c-ip_based_schemes"></a>

          
          <div class="method-heading">
            <span class="method-name">ip_based_schemes</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns an array of known ip-based schemes. These schemes typically use a
similar <a href="URI.html">URI</a> form:
<tt>//&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;url-path&gt;</tt></p>
            

            
            <div class="method-source-code" id="ip_based_schemes-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1114</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">ip_based_schemes</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">port_mapping</span>.<span class="ruby-identifier">keys</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- ip_based_schemes-source -->
            
          </div>

          

          
        </div><!-- ip_based_schemes-method -->

      
        <div id="join-method" class="method-detail ">
          <a name="method-c-join"></a>

          
          <div class="method-heading">
            <span class="method-name">join</span><span
              class="method-args">(*uris)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Joins several URIs together.</p>

<p>@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">to_str</a>] *uris</p>

<pre>The URIs to join.</pre>

<p>@return [Addressable::URI] The joined <a href="URI.html">URI</a>.</p>

<p>@example</p>

<pre>base = &quot;http://example.com/&quot;
uri = Addressable::URI.parse(&quot;relative/path&quot;)
Addressable::URI.join(base, uri)
#=&gt; #&lt;Addressable::URI:0xcab390 URI:http://example.com/relative/path&gt;</pre>
            

            
            <div class="method-source-code" id="join-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 279</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">join</span>(*<span class="ruby-identifier">uris</span>)
  <span class="ruby-identifier">uri_objects</span> = <span class="ruby-identifier">uris</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">uri</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-keyword">self</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">result</span> = <span class="ruby-identifier">uri_objects</span>.<span class="ruby-identifier">shift</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">uri</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">uri_objects</span>
    <span class="ruby-identifier">result</span>.<span class="ruby-identifier">join!</span>(<span class="ruby-identifier">uri</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">result</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- join-source -->
            
          </div>

          

          
        </div><!-- join-method -->

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">(options={})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Creates a new uri object from component parts.</p>

<p>@option [String, <a href="URI.html#method-i-to_str">to_str</a>] scheme The
scheme component. @option [String, <a
href="URI.html#method-i-to_str">to_str</a>] user The user component.
@option [String, <a href="URI.html#method-i-to_str">to_str</a>] password
The password component. @option [String, <a
href="URI.html#method-i-to_str">to_str</a>] userinfo</p>

<pre>The userinfo component. If this is supplied, the user and password
components must be omitted.</pre>

<p>@option [String, <a href="URI.html#method-i-to_str">to_str</a>] host The
host component. @option [String, <a
href="URI.html#method-i-to_str">to_str</a>] port The port component.
@option [String, <a href="URI.html#method-i-to_str">to_str</a>] authority</p>

<pre>The authority component. If this is supplied, the user, password,
userinfo, host, and port components must be omitted.</pre>

<p>@option [String, <a href="URI.html#method-i-to_str">to_str</a>] path The
path component. @option [String, <a
href="URI.html#method-i-to_str">to_str</a>] query The query component.
@option [String, <a href="URI.html#method-i-to_str">to_str</a>] fragment
The fragment component.</p>

<p>@return [Addressable::URI] The constructed <a href="URI.html">URI</a>
object.</p>
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 690</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">options</span>={})
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:authority</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">options</span>.<span class="ruby-identifier">keys</span> &amp; [<span class="ruby-value">:userinfo</span>, <span class="ruby-value">:user</span>, <span class="ruby-value">:password</span>, <span class="ruby-value">:host</span>, <span class="ruby-value">:port</span>]).<span class="ruby-identifier">any?</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
        <span class="ruby-string">&quot;Cannot specify both an authority and any of the components &quot;</span> <span class="ruby-operator">+</span>
        <span class="ruby-string">&quot;within the authority.&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:userinfo</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">options</span>.<span class="ruby-identifier">keys</span> &amp; [<span class="ruby-value">:user</span>, <span class="ruby-value">:password</span>]).<span class="ruby-identifier">any?</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
        <span class="ruby-string">&quot;Cannot specify both a userinfo and either the user or password.&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">defer_validation</span> <span class="ruby-keyword">do</span>
    <span class="ruby-comment"># Bunch of crazy logic required because of the composite components</span>
    <span class="ruby-comment"># like userinfo and authority.</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:scheme</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:scheme</span>]
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:user</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:user</span>]
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:password</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:password</span>]
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">userinfo</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:userinfo</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:userinfo</span>]
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:host</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:host</span>]
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">port</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:port</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:port</span>]
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">authority</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:authority</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:authority</span>]
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:path</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:path</span>]
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:query</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:query</span>]
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">fragment</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:fragment</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:fragment</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
        <div id="normalize_component-method" class="method-detail ">
          <a name="method-c-normalize_component"></a>

          
          <div class="method-heading">
            <span class="method-name">normalize_component</span><span
              class="method-args">(component, character_class= CharacterClasses::RESERVED + CharacterClasses::UNRESERVED)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Normalizes the encoding of a <a href="URI.html">URI</a> component.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>] component
The <a href="URI.html">URI</a> component to encode.</p>

<p>@param [String, Regexp] character_class</p>

<pre>The characters which are not percent encoded. If a &lt;code&gt;String&lt;/code&gt;
is passed, the &lt;code&gt;String&lt;/code&gt; must be formatted as a regular
expression character class. (Do not include the surrounding square
brackets.)  For example, &lt;code&gt;&quot;b-zB-Z0-9&quot;&lt;/code&gt; would cause
everything but the letters 'b' through 'z' and the numbers '0'
through '9' to be percent encoded. If a &lt;code&gt;Regexp&lt;/code&gt; is passed,
the value &lt;code&gt;/[^b-zB-Z0-9]/&lt;/code&gt; would have the same effect. A
set of useful &lt;code&gt;String&lt;/code&gt; values may be found in the
&lt;code&gt;Addressable::URI::CharacterClasses&lt;/code&gt; module. The default
value is the reserved plus unreserved character classes specified in
&lt;a href=&quot;http://www.ietf.org/rfc/rfc3986.txt&quot;&gt;RFC 3986&lt;/a&gt;.</pre>

<p>@return [String] The normalized component.</p>

<p>@example</p>

<pre>Addressable::URI.normalize_component(&quot;simpl%65/%65xampl%65&quot;, &quot;b-zB-Z&quot;)
=&gt; &quot;simple%2Fex%61mple&quot;
Addressable::URI.normalize_component(
  &quot;simpl%65/%65xampl%65&quot;, /[^b-zB-Z]/
)
=&gt; &quot;simple%2Fex%61mple&quot;
Addressable::URI.normalize_component(
  &quot;simpl%65/%65xampl%65&quot;,
  Addressable::URI::CharacterClasses::UNRESERVED
)
=&gt; &quot;simple%2Fexample&quot;</pre>
            

            
            <div class="method-source-code" id="normalize_component-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 435</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalize_component</span>(<span class="ruby-identifier">component</span>, <span class="ruby-identifier">character_class</span>=
    <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">RESERVED</span> <span class="ruby-operator">+</span> <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">component</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">component</span> = <span class="ruby-identifier">component</span>.<span class="ruby-identifier">to_str</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>, <span class="ruby-constant">TypeError</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{component.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">component</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span>[<span class="ruby-constant">String</span>, <span class="ruby-constant">Regexp</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">character_class</span>.<span class="ruby-identifier">class</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>,
      <span class="ruby-node">&quot;Expected String or Regexp, got #{character_class.inspect}&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">character_class</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">String</span>)
    <span class="ruby-identifier">character_class</span> = <span class="ruby-node">/[^#{character_class}]/</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">component</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:force_encoding</span>)
    <span class="ruby-comment"># We can't perform regexps on invalid UTF sequences, but</span>
    <span class="ruby-comment"># here we need to, so switch to ASCII.</span>
    <span class="ruby-identifier">component</span> = <span class="ruby-identifier">component</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-identifier">component</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-constant">Encoding</span><span class="ruby-operator">::</span><span class="ruby-constant">ASCII_8BIT</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">unencoded</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">component</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">encoded</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">IDNA</span>.<span class="ruby-identifier">unicode_normalize_kc</span>(<span class="ruby-identifier">unencoded</span>),
      <span class="ruby-identifier">character_class</span>
    )
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">ArgumentError</span>
    <span class="ruby-identifier">encoded</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">unencoded</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">encoded</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalize_component-source -->
            
          </div>

          

          
        </div><!-- normalize_component-method -->

      
        <div id="normalized_encode-method" class="method-detail ">
          <a name="method-c-normalized_encode"></a>

          
          <div class="method-heading">
            <span class="method-name">normalized_encode</span><span
              class="method-args">(uri, returning=String)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Normalizes the encoding of a <a href="URI.html">URI</a>. Characters within
a hostname are not percent encoded to allow for internationalized domain
names.</p>

<p>@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">to_str</a>] uri</p>

<pre>The URI to encode.</pre>

<p>@param [Class] returning</p>

<pre>The type of object to return.
This value may only be set to &lt;code&gt;String&lt;/code&gt; or
&lt;code&gt;Addressable::URI&lt;/code&gt;. All other values are invalid. Defaults
to &lt;code&gt;String&lt;/code&gt;.</pre>

<p>@return [String, Addressable::URI]</p>

<pre>The encoded URI.
The return type is determined by the &lt;code&gt;returning&lt;/code&gt; parameter.</pre>
            

            
            <div class="method-source-code" id="normalized_encode-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 539</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_encode</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">returning</span>=<span class="ruby-constant">String</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>, <span class="ruby-constant">TypeError</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span>[<span class="ruby-constant">String</span>, <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">returning</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>,
      <span class="ruby-string">&quot;Expected Class (String or Addressable::URI), &quot;</span> <span class="ruby-operator">+</span>
      <span class="ruby-node">&quot;got #{returning.inspect}&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">uri_object</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-keyword">self</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>)
  <span class="ruby-identifier">components</span> = {
    <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">scheme</span>),
    <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">user</span>),
    <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">password</span>),
    <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">host</span>),
    <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">port</span>,
    <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">path</span>),
    <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">query</span>),
    <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">fragment</span>)
  }
  <span class="ruby-identifier">components</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
      <span class="ruby-keyword">begin</span>
        <span class="ruby-identifier">components</span>[<span class="ruby-identifier">key</span>] =
          <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">IDNA</span>.<span class="ruby-identifier">unicode_normalize_kc</span>(<span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_str</span>)
      <span class="ruby-keyword">rescue</span> <span class="ruby-constant">ArgumentError</span>
        <span class="ruby-comment"># Likely a malformed UTF-8 character, skip unicode normalization</span>
        <span class="ruby-identifier">components</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_str</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">encoded_uri</span> = <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(
    <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">components</span>[<span class="ruby-value">:scheme</span>],
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">SCHEME</span>),
    <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">components</span>[<span class="ruby-value">:user</span>],
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>),
    <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">components</span>[<span class="ruby-value">:password</span>],
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>),
    <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:host</span>],
    <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:port</span>],
    <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">components</span>[<span class="ruby-value">:path</span>],
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH</span>),
    <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">components</span>[<span class="ruby-value">:query</span>],
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">QUERY</span>),
    <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">components</span>[<span class="ruby-value">:fragment</span>],
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">FRAGMENT</span>)
  )
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">returning</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">encoded_uri</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">returning</span> <span class="ruby-operator">==</span> <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">encoded_uri</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalized_encode-source -->
            
          </div>

          

          
        </div><!-- normalized_encode-method -->

      
        <div id="parse-method" class="method-detail ">
          <a name="method-c-parse"></a>

          
          <div class="method-heading">
            <span class="method-name">parse</span><span
              class="method-args">(uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns a <a href="URI.html">URI</a> object based on the parsed string.</p>

<p>@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">to_str</a>] uri</p>

<pre>The URI string to parse.
No parsing is performed if the object is already an
&lt;code&gt;Addressable::URI&lt;/code&gt;.</pre>

<p>@return [Addressable::URI] The parsed <a href="URI.html">URI</a>.</p>
            

            
            <div class="method-source-code" id="parse-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 82</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>)
  <span class="ruby-comment"># If we were given nil, return nil.</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">uri</span>
  <span class="ruby-comment"># If a URI object is passed, just return itself.</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">dup</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-keyword">self</span>)

  <span class="ruby-comment"># If a URI object of the Ruby standard library variety is passed,</span>
  <span class="ruby-comment"># convert it to a string, then parse the string.</span>
  <span class="ruby-comment"># We do the check this way because we don't want to accidentally</span>
  <span class="ruby-comment"># cause a missing constant exception to be thrown.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^URI\b/</span>
    <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Otherwise, convert to a String</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-constant">NoMethodError</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">not</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>

  <span class="ruby-comment"># This Regexp supplied as an example in RFC 3986, and it works great.</span>
  <span class="ruby-identifier">scan</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-constant">URIREGEX</span>)
  <span class="ruby-identifier">fragments</span> = <span class="ruby-identifier">scan</span>[<span class="ruby-value">0</span>]
  <span class="ruby-identifier">scheme</span> = <span class="ruby-identifier">fragments</span>[<span class="ruby-value">1</span>]
  <span class="ruby-identifier">authority</span> = <span class="ruby-identifier">fragments</span>[<span class="ruby-value">3</span>]
  <span class="ruby-identifier">path</span> = <span class="ruby-identifier">fragments</span>[<span class="ruby-value">4</span>]
  <span class="ruby-identifier">query</span> = <span class="ruby-identifier">fragments</span>[<span class="ruby-value">6</span>]
  <span class="ruby-identifier">fragment</span> = <span class="ruby-identifier">fragments</span>[<span class="ruby-value">8</span>]
  <span class="ruby-identifier">user</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">password</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">host</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">port</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">authority</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-comment"># The Regexp above doesn't split apart the authority.</span>
    <span class="ruby-identifier">userinfo</span> = <span class="ruby-identifier">authority</span>[<span class="ruby-regexp">/^([^\[\]]*)@/</span>, <span class="ruby-value">1</span>]
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">userinfo</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">user</span> = <span class="ruby-identifier">userinfo</span>.<span class="ruby-identifier">strip</span>[<span class="ruby-regexp">/^([^:]*):?/</span>, <span class="ruby-value">1</span>]
      <span class="ruby-identifier">password</span> = <span class="ruby-identifier">userinfo</span>.<span class="ruby-identifier">strip</span>[<span class="ruby-regexp">/:(.*)$/</span>, <span class="ruby-value">1</span>]
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">host</span> = <span class="ruby-identifier">authority</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/^([^\[\]]*)@/</span>, <span class="ruby-constant">EMPTYSTR</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/:([^:@\[\]]*?)$/</span>, <span class="ruby-constant">EMPTYSTR</span>)
    <span class="ruby-identifier">port</span> = <span class="ruby-identifier">authority</span>[<span class="ruby-regexp">/:([^:@\[\]]*?)$/</span>, <span class="ruby-value">1</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">port</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EMPTYSTR</span>
    <span class="ruby-identifier">port</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(
    <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">scheme</span>,
    <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">user</span>,
    <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">password</span>,
    <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">host</span>,
    <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">port</span>,
    <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">path</span>,
    <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">query</span>,
    <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">fragment</span>
  )
<span class="ruby-keyword">end</span></pre>
            </div><!-- parse-source -->
            
          </div>

          

          
        </div><!-- parse-method -->

      
        <div id="port_mapping-method" class="method-detail ">
          <a name="method-c-port_mapping"></a>

          
          <div class="method-heading">
            <span class="method-name">port_mapping</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns a hash of common IP-based schemes and their default port numbers.
Adding new schemes to this hash, as necessary, will allow for better <a
href="URI.html">URI</a> normalization.</p>
            

            
            <div class="method-source-code" id="port_mapping-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1121</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">port_mapping</span>
  <span class="ruby-constant">PORT_MAPPING</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- port_mapping-source -->
            
          </div>

          

          
        </div><!-- port_mapping-method -->

      
        <div id="unencode-method" class="method-detail ">
          <a name="method-c-unencode"></a>

          
          <div class="method-heading">
            <span class="method-name">unencode</span><span
              class="method-args">(uri, returning=String)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Unencodes any percent encoded characters within a <a
href="URI.html">URI</a> component. This method may be used for unencoding
either components or full URIs, however, it is recommended to use the
<tt>unencode_component</tt> alias when unencoding components.</p>

<p>@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">to_str</a>] uri</p>

<pre>The URI or component to unencode.</pre>

<p>@param [Class] returning</p>

<pre>The type of object to return.
This value may only be set to &lt;code&gt;String&lt;/code&gt; or
&lt;code&gt;Addressable::URI&lt;/code&gt;. All other values are invalid. Defaults
to &lt;code&gt;String&lt;/code&gt;.</pre>

<p>@return [String, Addressable::URI]</p>

<pre>The unencoded component or URI.
The return type is determined by the &lt;code&gt;returning&lt;/code&gt; parameter.</pre>
            

            
            <div class="method-source-code" id="unencode-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 372</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unencode</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">returning</span>=<span class="ruby-constant">String</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NoMethodError</span>, <span class="ruby-constant">TypeError</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span>[<span class="ruby-constant">String</span>, <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">returning</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>,
      <span class="ruby-string">&quot;Expected Class (String or Addressable::URI), &quot;</span> <span class="ruby-operator">+</span>
      <span class="ruby-node">&quot;got #{returning.inspect}&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">result</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/%[0-9a-f]{2}/</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sequence</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">sequence</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">3</span>].<span class="ruby-identifier">to_i</span>(<span class="ruby-value">16</span>).<span class="ruby-identifier">chr</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">result</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-string">&quot;utf-8&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:force_encoding</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">returning</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">result</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">returning</span> <span class="ruby-operator">==</span> <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>
    <span class="ruby-keyword">return</span> <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">result</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- unencode-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="URI.html#method-c-unescape">unescape</a>, <a href="URI.html#method-c-unencode_component">unencode_component</a>, <a href="URI.html#method-c-unescape_component">unescape_component</a>
          </div>
          

          
        </div><!-- unencode-method -->

      
        <div id="unencode_component-method" class="method-detail method-alias">
          <a name="method-c-unencode_component"></a>

          
          <div class="method-heading">
            <span class="method-name">unencode_component</span><span
              class="method-args">(uri, returning=String)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="URI.html#method-c-unencode">unencode</a>
          </div>
          
        </div><!-- unencode_component-method -->

      
        <div id="unescape-method" class="method-detail method-alias">
          <a name="method-c-unescape"></a>

          
          <div class="method-heading">
            <span class="method-name">unescape</span><span
              class="method-args">(uri, returning=String)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="URI.html#method-c-unencode">unencode</a>
          </div>
          
        </div><!-- unescape-method -->

      
        <div id="unescape_component-method" class="method-detail method-alias">
          <a name="method-c-unescape_component"></a>

          
          <div class="method-heading">
            <span class="method-name">unescape_component</span><span
              class="method-args">(uri, returning=String)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="URI.html#method-c-unencode">unencode</a>
          </div>
          
        </div><!-- unescape_component-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="2B-method" class="method-detail method-alias">
          <a name="method-i-2B"></a>

          
          <div class="method-heading">
            <span class="method-name">+</span><span
              class="method-args">(uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="URI.html#method-i-join">join</a>
          </div>
          
        </div><!-- 2B-method -->

      
        <div id="3D-3D-method" class="method-detail ">
          <a name="method-i-3D-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">==</span><span
              class="method-args">(uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns <tt>true</tt> if the <a href="URI.html">URI</a> objects are equal.
This method normalizes both URIs before doing the comparison.</p>

<p>@param [Object] uri The <a href="URI.html">URI</a> to compare.</p>

<p>@return [TrueClass, FalseClass]</p>

<pre>&lt;code&gt;true&lt;/code&gt; if the URIs are equivalent, &lt;code&gt;false&lt;/code&gt;
otherwise.</pre>
            

            
            <div class="method-source-code" id="3D-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1997</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">uri</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">URI</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalize</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">normalize</span>.<span class="ruby-identifier">to_s</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- 3D-3D-source -->
            
          </div>

          

          
        </div><!-- 3D-3D-method -->

      
        <div id="3D-3D-3D-method" class="method-detail ">
          <a name="method-i-3D-3D-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">===</span><span
              class="method-args">(uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns <tt>true</tt> if the <a href="URI.html">URI</a> objects are equal.
This method normalizes both URIs before doing the comparison, and allows
comparison against <tt>Strings</tt>.</p>

<p>@param [Object] uri The <a href="URI.html">URI</a> to compare.</p>

<p>@return [TrueClass, FalseClass]</p>

<pre>&lt;code&gt;true&lt;/code&gt; if the URIs are equivalent, &lt;code&gt;false&lt;/code&gt;
otherwise.</pre>
            

            
            <div class="method-source-code" id="3D-3D-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1975</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">===</span>(<span class="ruby-identifier">uri</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:normalize</span>)
    <span class="ruby-identifier">uri_string</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">normalize</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">uri_string</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>).<span class="ruby-identifier">normalize</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">InvalidURIError</span>, <span class="ruby-constant">TypeError</span>
      <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalize</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri_string</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- 3D-3D-3D-source -->
            
          </div>

          

          
        </div><!-- 3D-3D-3D-method -->

      
        <div id="absolute-3F-method" class="method-detail ">
          <a name="method-i-absolute-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">absolute?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Determines if the <a href="URI.html">URI</a> is absolute.</p>

<p>@return [TrueClass, FalseClass]</p>

<pre>&lt;code&gt;true&lt;/code&gt; if the URI is absolute. &lt;code&gt;false&lt;/code&gt;
otherwise.</pre>
            

            
            <div class="method-source-code" id="absolute-3F-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1644</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">absolute?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-operator">!</span><span class="ruby-identifier">relative?</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- absolute-3F-source -->
            
          </div>

          

          
        </div><!-- absolute-3F-method -->

      
        <div id="authority-method" class="method-detail ">
          <a name="method-i-authority"></a>

          
          <div class="method-heading">
            <span class="method-name">authority</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The authority component for this <a href="URI.html">URI</a>. Combines the
user, password, host, and port components.</p>

<p>@return [String] The authority component.</p>
            

            
            <div class="method-source-code" id="authority-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1022</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">authority</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@authority</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">authority</span> = <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">userinfo</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">authority</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{self.userinfo}@&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">authority</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">port</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">authority</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;:#{self.port}&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">authority</span>
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- authority-source -->
            
          </div>

          

          
        </div><!-- authority-method -->

      
        <div id="authority-3D-method" class="method-detail ">
          <a name="method-i-authority-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">authority=</span><span
              class="method-args">(new_authority)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the authority component for this <a href="URI.html">URI</a>.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>]
new_authority The new authority component.</p>
            

            
            <div class="method-source-code" id="authority-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1058</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">authority=</span>(<span class="ruby-identifier">new_authority</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_authority</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_authority</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_authority.class} into String.&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">new_authority</span> = <span class="ruby-identifier">new_authority</span>.<span class="ruby-identifier">to_str</span>
    <span class="ruby-identifier">new_userinfo</span> = <span class="ruby-identifier">new_authority</span>[<span class="ruby-regexp">/^([^\[\]]*)@/</span>, <span class="ruby-value">1</span>]
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_userinfo</span>
      <span class="ruby-identifier">new_user</span> = <span class="ruby-identifier">new_userinfo</span>.<span class="ruby-identifier">strip</span>[<span class="ruby-regexp">/^([^:]*):?/</span>, <span class="ruby-value">1</span>]
      <span class="ruby-identifier">new_password</span> = <span class="ruby-identifier">new_userinfo</span>.<span class="ruby-identifier">strip</span>[<span class="ruby-regexp">/:(.*)$/</span>, <span class="ruby-value">1</span>]
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">new_host</span> =
      <span class="ruby-identifier">new_authority</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/^([^\[\]]*)@/</span>, <span class="ruby-constant">EMPTYSTR</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/:([^:@\[\]]*?)$/</span>, <span class="ruby-constant">EMPTYSTR</span>)
    <span class="ruby-identifier">new_port</span> =
      <span class="ruby-identifier">new_authority</span>[<span class="ruby-regexp">/:([^:@\[\]]*?)$/</span>, <span class="ruby-value">1</span>]
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Password assigned first to ensure validity in case of nil</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span> = <span class="ruby-keyword">defined?</span>(<span class="ruby-identifier">new_password</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">new_password</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span> = <span class="ruby-keyword">defined?</span>(<span class="ruby-identifier">new_user</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">new_user</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span> = <span class="ruby-keyword">defined?</span>(<span class="ruby-identifier">new_host</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">new_host</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">port</span> = <span class="ruby-keyword">defined?</span>(<span class="ruby-identifier">new_port</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">new_port</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Reset dependant values</span>
  <span class="ruby-ivar">@userinfo</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@normalized_userinfo</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Ensure we haven't created an invalid URI</span>
  <span class="ruby-identifier">validate</span>()
<span class="ruby-keyword">end</span></pre>
            </div><!-- authority-3D-source -->
            
          </div>

          

          
        </div><!-- authority-3D-method -->

      
        <div id="basename-method" class="method-detail ">
          <a name="method-i-basename"></a>

          
          <div class="method-heading">
            <span class="method-name">basename</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The basename, if any, of the file in the path component.</p>

<p>@return [String] The path’s basename.</p>
            

            
            <div class="method-source-code" id="basename-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1314</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">basename</span>
  <span class="ruby-comment"># Path cannot be nil</span>
  <span class="ruby-keyword">return</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/;[^\/]*$/</span>, <span class="ruby-constant">EMPTYSTR</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- basename-source -->
            
          </div>

          

          
        </div><!-- basename-method -->

      
        <div id="defer_validation-method" class="method-detail ">
          <a name="method-i-defer_validation"></a>

          
          <div class="method-heading">
            <span class="method-name">defer_validation</span><span
              class="method-args">(&block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>This method allows you to make several changes to a <a
href="URI.html">URI</a> simultaneously, which separately would cause
validation errors, but in conjunction, are valid.  The <a
href="URI.html">URI</a> will be revalidated as soon as the entire block has
been executed.</p>

<p>@param [Proc] block</p>

<pre>A set of operations to perform on a given URI.</pre>
            

            
            <div class="method-source-code" id="defer_validation-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 2147</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">defer_validation</span>(&amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">LocalJumpError</span>, <span class="ruby-string">&quot;No block given.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block</span>
  <span class="ruby-ivar">@validation_deferred</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>()
  <span class="ruby-ivar">@validation_deferred</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">validate</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- defer_validation-source -->
            
          </div>

          

          
        </div><!-- defer_validation-method -->

      
        <div id="display_uri-method" class="method-detail ">
          <a name="method-i-display_uri"></a>

          
          <div class="method-heading">
            <span class="method-name">display_uri</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Creates a <a href="URI.html">URI</a> suitable for display to users. If
semantic attacks are likely, the application should try to detect these and
warn the user. See &lt;a href=“<a
href="http://www.ietf.org/rfc/rfc3986.txt">RFC”>www.ietf.org/rfc/rfc3986.txt“>RFC</a>
3986&lt;/a&gt;, section 7.6 for more information.</p>

<p>@return [Addressable::URI] A <a href="URI.html">URI</a> suitable for
display purposes.</p>
            

            
            <div class="method-source-code" id="display_uri-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1959</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">display_uri</span>
  <span class="ruby-identifier">display_uri</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalize</span>
  <span class="ruby-identifier">display_uri</span>.<span class="ruby-identifier">host</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">IDNA</span>.<span class="ruby-identifier">to_unicode</span>(<span class="ruby-identifier">display_uri</span>.<span class="ruby-identifier">host</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">display_uri</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- display_uri-source -->
            
          </div>

          

          
        </div><!-- display_uri-method -->

      
        <div id="dup-method" class="method-detail ">
          <a name="method-i-dup"></a>

          
          <div class="method-heading">
            <span class="method-name">dup</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Clones the <a href="URI.html">URI</a> object.</p>

<p>@return [Addressable::URI] The cloned <a href="URI.html">URI</a>.</p>
            

            
            <div class="method-source-code" id="dup-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 2029</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">duplicated_uri</span> = <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(
    <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">port</span>,
    <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>,
    <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">fragment</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">fragment</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
  )
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">duplicated_uri</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- dup-source -->
            
          </div>

          

          
        </div><!-- dup-method -->

      
        <div id="eql-3F-method" class="method-detail ">
          <a name="method-i-eql-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">eql?</span><span
              class="method-args">(uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns <tt>true</tt> if the <a href="URI.html">URI</a> objects are equal.
This method does NOT normalize either <a href="URI.html">URI</a> before
doing the comparison.</p>

<p>@param [Object] uri The <a href="URI.html">URI</a> to compare.</p>

<p>@return [TrueClass, FalseClass]</p>

<pre>&lt;code&gt;true&lt;/code&gt; if the URIs are equivalent, &lt;code&gt;false&lt;/code&gt;
otherwise.</pre>
            

            
            <div class="method-source-code" id="eql-3F-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 2011</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">eql?</span>(<span class="ruby-identifier">uri</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">URI</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_s</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- eql-3F-source -->
            
          </div>

          

          
        </div><!-- eql-3F-method -->

      
        <div id="extname-method" class="method-detail ">
          <a name="method-i-extname"></a>

          
          <div class="method-heading">
            <span class="method-name">extname</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The extname, if any, of the file in the path component. Empty string if
there is no extension.</p>

<p>@return [String] The path’s extname.</p>
            

            
            <div class="method-source-code" id="extname-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1324</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">extname</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>
  <span class="ruby-keyword">return</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">extname</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">basename</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- extname-source -->
            
          </div>

          

          
        </div><!-- extname-method -->

      
        <div id="fragment-method" class="method-detail ">
          <a name="method-i-fragment"></a>

          
          <div class="method-heading">
            <span class="method-name">fragment</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The fragment component for this <a href="URI.html">URI</a>.</p>

<p>@return [String] The fragment component.</p>
            

            
            <div class="method-source-code" id="fragment-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1578</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fragment</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@fragment</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@fragment</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- fragment-source -->
            
          </div>

          

          
        </div><!-- fragment-method -->

      
        <div id="fragment-3D-method" class="method-detail ">
          <a name="method-i-fragment-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">fragment=</span><span
              class="method-args">(new_fragment)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the fragment component for this <a href="URI.html">URI</a>.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>] new_fragment
The new fragment component.</p>
            

            
            <div class="method-source-code" id="fragment-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1599</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fragment=</span>(<span class="ruby-identifier">new_fragment</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_fragment</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_fragment</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_fragment.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@fragment</span> = <span class="ruby-identifier">new_fragment</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">new_fragment</span>.<span class="ruby-identifier">to_str</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Reset dependant values</span>
  <span class="ruby-ivar">@normalized_fragment</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Ensure we haven't created an invalid URI</span>
  <span class="ruby-identifier">validate</span>()
<span class="ruby-keyword">end</span></pre>
            </div><!-- fragment-3D-source -->
            
          </div>

          

          
        </div><!-- fragment-3D-method -->

      
        <div id="freeze-method" class="method-detail ">
          <a name="method-i-freeze"></a>

          
          <div class="method-heading">
            <span class="method-name">freeze</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Freeze <a href="URI.html">URI</a>, initializing instance variables.</p>

<p>@return [Addressable::URI] The frozen <a href="URI.html">URI</a> object.</p>
            

            
            <div class="method-source-code" id="freeze-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 725</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">freeze</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_scheme</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_user</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_password</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_userinfo</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_host</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_port</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_authority</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_site</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_path</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_query</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_fragment</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">hash</span>
  <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- freeze-source -->
            
          </div>

          

          
        </div><!-- freeze-method -->

      
        <div id="hash-method" class="method-detail ">
          <a name="method-i-hash"></a>

          
          <div class="method-heading">
            <span class="method-name">hash</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>A hash value that will make a <a href="URI.html">URI</a> equivalent to its
normalized form.</p>

<p>@return [Integer] A hash of the <a href="URI.html">URI</a>.</p>
            

            
            <div class="method-source-code" id="hash-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 2021</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">hash</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@hash</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">hash</span> * <span class="ruby-value">-1</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- hash-source -->
            
          </div>

          

          
        </div><!-- hash-method -->

      
        <div id="host-method" class="method-detail ">
          <a name="method-i-host"></a>

          
          <div class="method-heading">
            <span class="method-name">host</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The host component for this <a href="URI.html">URI</a>.</p>

<p>@return [String] The host component.</p>
            

            
            <div class="method-source-code" id="host-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 968</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">host</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@host</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@host</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- host-source -->
            
          </div>

          

          
        </div><!-- host-method -->

      
        <div id="host-3D-method" class="method-detail ">
          <a name="method-i-host-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">host=</span><span
              class="method-args">(new_host)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the host component for this <a href="URI.html">URI</a>.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>] new_host The
new host component.</p>
            

            
            <div class="method-source-code" id="host-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1001</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">host=</span>(<span class="ruby-identifier">new_host</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_host</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_host</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_host.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@host</span> = <span class="ruby-identifier">new_host</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">new_host</span>.<span class="ruby-identifier">to_str</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Reset dependant values</span>
  <span class="ruby-ivar">@authority</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@normalized_host</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Ensure we haven't created an invalid URI</span>
  <span class="ruby-identifier">validate</span>()
<span class="ruby-keyword">end</span></pre>
            </div><!-- host-3D-source -->
            
          </div>

          

          
        </div><!-- host-3D-method -->

      
        <div id="inferred_port-method" class="method-detail ">
          <a name="method-i-inferred_port"></a>

          
          <div class="method-heading">
            <span class="method-name">inferred_port</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The inferred port component for this <a href="URI.html">URI</a>. This
method will normalize to the default port for the URI’s scheme if the port
isn’t explicitly specified in the <a href="URI.html">URI</a>.</p>

<p>@return [Integer] The inferred port component.</p>
            

            
            <div class="method-source-code" id="inferred_port-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1179</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inferred_port</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">port</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span>
      <span class="ruby-constant">URI</span>.<span class="ruby-identifier">port_mapping</span>[<span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">downcase</span>]
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">port</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- inferred_port-source -->
            
          </div>

          

          
        </div><!-- inferred_port-method -->

      
        <div id="inspect-method" class="method-detail ">
          <a name="method-i-inspect"></a>

          
          <div class="method-heading">
            <span class="method-name">inspect</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns a <tt>String</tt> representation of the <a href="URI.html">URI</a>
object’s state.</p>

<p>@return [String] The <a href="URI.html">URI</a> object’s state, as a
<tt>String</tt>.</p>
            

            
            <div class="method-source-code" id="inspect-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 2135</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inspect</span>
  <span class="ruby-identifier">sprintf</span>(<span class="ruby-node">&quot;#&lt;%s:%#0x URI:%s&gt;&quot;</span>, <span class="ruby-constant">URI</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">object_id</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- inspect-source -->
            
          </div>

          

          
        </div><!-- inspect-method -->

      
        <div id="ip_based-3F-method" class="method-detail ">
          <a name="method-i-ip_based-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">ip_based?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Determines if the scheme indicates an IP-based protocol.</p>

<p>@return [TrueClass, FalseClass]</p>

<pre>&lt;code&gt;true&lt;/code&gt; if the scheme indicates an IP-based protocol.
&lt;code&gt;false&lt;/code&gt; otherwise.</pre>
            

            
            <div class="method-source-code" id="ip_based-3F-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1620</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ip_based?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span>
    <span class="ruby-keyword">return</span> <span class="ruby-constant">URI</span>.<span class="ruby-identifier">ip_based_schemes</span>.<span class="ruby-identifier">include?</span>(
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">downcase</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- ip_based-3F-source -->
            
          </div>

          

          
        </div><!-- ip_based-3F-method -->

      
        <div id="join-method" class="method-detail ">
          <a name="method-i-join"></a>

          
          <div class="method-heading">
            <span class="method-name">join</span><span
              class="method-args">(uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Joins two URIs together.</p>

<p>@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">to_str</a>] The <a href="URI.html">URI</a>
to join with.</p>

<p>@return [Addressable::URI] The joined <a href="URI.html">URI</a>.</p>
            

            
            <div class="method-source-code" id="join-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1654</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">join</span>(<span class="ruby-identifier">uri</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">URI</span>)
    <span class="ruby-comment"># Otherwise, convert to a String, then parse.</span>
    <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">joined_scheme</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">joined_user</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">joined_password</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">joined_host</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">joined_port</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">joined_path</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">joined_query</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">joined_fragment</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Section 5.2.2 of RFC 3986</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-identifier">joined_scheme</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span>
    <span class="ruby-identifier">joined_user</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">user</span>
    <span class="ruby-identifier">joined_password</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">password</span>
    <span class="ruby-identifier">joined_host</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>
    <span class="ruby-identifier">joined_port</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span>
    <span class="ruby-identifier">joined_path</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_path</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>)
    <span class="ruby-identifier">joined_query</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">authority</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">joined_user</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">user</span>
      <span class="ruby-identifier">joined_password</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">password</span>
      <span class="ruby-identifier">joined_host</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>
      <span class="ruby-identifier">joined_port</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span>
      <span class="ruby-identifier">joined_path</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_path</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>)
      <span class="ruby-identifier">joined_query</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">empty?</span>
        <span class="ruby-identifier">joined_path</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
          <span class="ruby-identifier">joined_query</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">joined_query</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-constant">SLASH</span>
          <span class="ruby-identifier">joined_path</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_path</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">base_path</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">dup</span>
          <span class="ruby-identifier">base_path</span> = <span class="ruby-constant">EMPTYSTR</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">base_path</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>
          <span class="ruby-identifier">base_path</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_path</span>(<span class="ruby-identifier">base_path</span>)

          <span class="ruby-comment"># Section 5.2.3 of RFC 3986</span>
          <span class="ruby-comment">#</span>
          <span class="ruby-comment"># Removes the right-most path segment from the base path.</span>
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">base_path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\//</span>
            <span class="ruby-identifier">base_path</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/\/[^\/]+$/</span>, <span class="ruby-constant">SLASH</span>)
          <span class="ruby-keyword">else</span>
            <span class="ruby-identifier">base_path</span> = <span class="ruby-constant">EMPTYSTR</span>
          <span class="ruby-keyword">end</span>

          <span class="ruby-comment"># If the base path is empty and an authority segment has been</span>
          <span class="ruby-comment"># defined, use a base path of SLASH</span>
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">base_path</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">authority</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
            <span class="ruby-identifier">base_path</span> = <span class="ruby-constant">SLASH</span>
          <span class="ruby-keyword">end</span>

          <span class="ruby-identifier">joined_path</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_path</span>(<span class="ruby-identifier">base_path</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">joined_query</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">joined_user</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span>
      <span class="ruby-identifier">joined_password</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span>
      <span class="ruby-identifier">joined_host</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span>
      <span class="ruby-identifier">joined_port</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">port</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">joined_scheme</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">joined_fragment</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">fragment</span>

  <span class="ruby-keyword">return</span> <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(
    <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_scheme</span>,
    <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_user</span>,
    <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_password</span>,
    <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_host</span>,
    <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_port</span>,
    <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_path</span>,
    <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_query</span>,
    <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_fragment</span>
  )
<span class="ruby-keyword">end</span></pre>
            </div><!-- join-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="URI.html#method-i-2B">+</a>
          </div>
          

          
        </div><!-- join-method -->

      
        <div id="join-21-method" class="method-detail ">
          <a name="method-i-join-21"></a>

          
          <div class="method-heading">
            <span class="method-name">join!</span><span
              class="method-args">(uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Destructive form of <tt>join</tt>.</p>

<p>@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">to_str</a>] The <a href="URI.html">URI</a>
to join with.</p>

<p>@return [Addressable::URI] The joined <a href="URI.html">URI</a>.</p>

<p>@see <a href="URI.html#method-i-join">Addressable::URI#join</a></p>
            

            
            <div class="method-source-code" id="join-21-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1757</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">join!</span>(<span class="ruby-identifier">uri</span>)
  <span class="ruby-identifier">replace_self</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">uri</span>))
<span class="ruby-keyword">end</span></pre>
            </div><!-- join-21-source -->
            
          </div>

          

          
        </div><!-- join-21-method -->

      
        <div id="merge-method" class="method-detail ">
          <a name="method-i-merge"></a>

          
          <div class="method-heading">
            <span class="method-name">merge</span><span
              class="method-args">(hash)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Merges a <a href="URI.html">URI</a> with a <tt>Hash</tt> of components.
This method has different behavior from <tt>join</tt>. Any components
present in the <tt>hash</tt> parameter will override the original
components. The path component is not treated specially.</p>

<p>@param [Hash, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_hash">to_hash</a>] The components to merge with.</p>

<p>@return [Addressable::URI] The merged <a href="URI.html">URI</a>.</p>

<p>@see Hash#merge</p>
            

            
            <div class="method-source-code" id="merge-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1772</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">merge</span>(<span class="ruby-identifier">hash</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">hash</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_hash</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{hash.class} into Hash.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">to_hash</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:authority</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">hash</span>.<span class="ruby-identifier">keys</span> &amp; [<span class="ruby-value">:userinfo</span>, <span class="ruby-value">:user</span>, <span class="ruby-value">:password</span>, <span class="ruby-value">:host</span>, <span class="ruby-value">:port</span>]).<span class="ruby-identifier">any?</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
        <span class="ruby-string">&quot;Cannot specify both an authority and any of the components &quot;</span> <span class="ruby-operator">+</span>
        <span class="ruby-string">&quot;within the authority.&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:userinfo</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">hash</span>.<span class="ruby-identifier">keys</span> &amp; [<span class="ruby-value">:user</span>, <span class="ruby-value">:password</span>]).<span class="ruby-identifier">any?</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
        <span class="ruby-string">&quot;Cannot specify both a userinfo and either the user or password.&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">uri</span> = <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">defer_validation</span> <span class="ruby-keyword">do</span>
    <span class="ruby-comment"># Bunch of crazy logic required because of the composite components</span>
    <span class="ruby-comment"># like userinfo and authority.</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span> =
      <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:scheme</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:scheme</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:authority</span>)
      <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">authority</span> =
        <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:authority</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:authority</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">authority</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:userinfo</span>)
      <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">userinfo</span> =
        <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:userinfo</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:userinfo</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">userinfo</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:userinfo</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:authority</span>)
      <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">user</span> =
        <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:user</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:user</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span>
      <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">password</span> =
        <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:password</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:password</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:authority</span>)
      <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span> =
        <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:host</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:host</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span>
      <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span> =
        <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:port</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:port</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">port</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span> =
      <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:path</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:path</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span> =
      <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:query</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:query</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span>
    <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">fragment</span> =
      <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:fragment</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:fragment</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">fragment</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">uri</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- merge-source -->
            
          </div>

          

          
        </div><!-- merge-method -->

      
        <div id="merge-21-method" class="method-detail ">
          <a name="method-i-merge-21"></a>

          
          <div class="method-heading">
            <span class="method-name">merge!</span><span
              class="method-args">(uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Destructive form of <tt>merge</tt>.</p>

<p>@param [Hash, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_hash">to_hash</a>] The components to merge with.</p>

<p>@return [Addressable::URI] The merged <a href="URI.html">URI</a>.</p>

<p>@see <a href="URI.html#method-i-merge">Addressable::URI#merge</a></p>
            

            
            <div class="method-source-code" id="merge-21-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1837</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">uri</span>)
  <span class="ruby-identifier">replace_self</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">uri</span>))
<span class="ruby-keyword">end</span></pre>
            </div><!-- merge-21-source -->
            
          </div>

          

          
        </div><!-- merge-21-method -->

      
        <div id="normalize-method" class="method-detail ">
          <a name="method-i-normalize"></a>

          
          <div class="method-heading">
            <span class="method-name">normalize</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns a normalized <a href="URI.html">URI</a> object.</p>

<p>NOTE: This method does not attempt to fully conform to specifications. It
exists largely to correct other people’s failures to read the
specifications, and also to deal with caching issues since several
different URIs may represent the same resource and should not be cached
multiple times.</p>

<p>@return [Addressable::URI] The normalized <a href="URI.html">URI</a>.</p>
            

            
            <div class="method-source-code" id="normalize-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1922</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalize</span>
  <span class="ruby-comment"># This is a special exception for the frequently misused feed</span>
  <span class="ruby-comment"># URI scheme.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">normalized_scheme</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;feed&quot;</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^feed:\/*http:\/*/</span>
      <span class="ruby-keyword">return</span> <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(
        <span class="ruby-keyword">self</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-regexp">/^feed:\/*(http:\/*.*)/</span>, <span class="ruby-value">1</span>]
      ).<span class="ruby-identifier">normalize</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(
    <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">normalized_scheme</span>,
    <span class="ruby-value">:authority</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">normalized_authority</span>,
    <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">normalized_path</span>,
    <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">normalized_query</span>,
    <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">normalized_fragment</span>
  )
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalize-source -->
            
          </div>

          

          
        </div><!-- normalize-method -->

      
        <div id="normalize-21-method" class="method-detail ">
          <a name="method-i-normalize-21"></a>

          
          <div class="method-heading">
            <span class="method-name">normalize!</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Destructively normalizes this <a href="URI.html">URI</a> object.</p>

<p>@return [Addressable::URI] The normalized <a href="URI.html">URI</a>.</p>

<p>@see <a href="URI.html#method-i-normalize">Addressable::URI#normalize</a></p>
            

            
            <div class="method-source-code" id="normalize-21-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1948</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalize!</span>
  <span class="ruby-identifier">replace_self</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalize</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalize-21-source -->
            
          </div>

          

          
        </div><!-- normalize-21-method -->

      
        <div id="normalized_authority-method" class="method-detail ">
          <a name="method-i-normalized_authority"></a>

          
          <div class="method-heading">
            <span class="method-name">normalized_authority</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The authority component for this <a href="URI.html">URI</a>, normalized.</p>

<p>@return [String] The authority component, normalized.</p>
            

            
            <div class="method-source-code" id="normalized_authority-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1040</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalized_authority</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">authority</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_authority</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">authority</span> = <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_userinfo</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">authority</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{self.normalized_userinfo}@&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">authority</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_host</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_port</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">authority</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;:#{self.normalized_port}&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">authority</span>
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalized_authority-source -->
            
          </div>

          

          
        </div><!-- normalized_authority-method -->

      
        <div id="normalized_fragment-method" class="method-detail ">
          <a name="method-i-normalized_fragment"></a>

          
          <div class="method-heading">
            <span class="method-name">normalized_fragment</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The fragment component for this <a href="URI.html">URI</a>, normalized.</p>

<p>@return [String] The fragment component, normalized.</p>
            

            
            <div class="method-source-code" id="normalized_fragment-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1586</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalized_fragment</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">fragment</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_fragment</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_component</span>(
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">fragment</span>.<span class="ruby-identifier">strip</span>,
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">FRAGMENT</span>
    )
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalized_fragment-source -->
            
          </div>

          

          
        </div><!-- normalized_fragment-method -->

      
        <div id="normalized_host-method" class="method-detail ">
          <a name="method-i-normalized_host"></a>

          
          <div class="method-heading">
            <span class="method-name">normalized_host</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The host component for this <a href="URI.html">URI</a>, normalized.</p>

<p>@return [String] The host component, normalized.</p>
            

            
            <div class="method-source-code" id="normalized_host-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 976</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalized_host</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_host</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span>
        <span class="ruby-identifier">result</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">IDNA</span>.<span class="ruby-identifier">to_ascii</span>(
          <span class="ruby-constant">URI</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">downcase</span>)
        )
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">result</span>[<span class="ruby-value">-1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;.&quot;</span>
          <span class="ruby-comment"># Trailing dots are unnecessary</span>
          <span class="ruby-identifier">result</span> = <span class="ruby-identifier">result</span>[<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-value">-1</span>]
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">result</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-constant">EMPTYSTR</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalized_host-source -->
            
          </div>

          

          
        </div><!-- normalized_host-method -->

      
        <div id="normalized_password-method" class="method-detail ">
          <a name="method-i-normalized_password"></a>

          
          <div class="method-heading">
            <span class="method-name">normalized_password</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The password component for this <a href="URI.html">URI</a>, normalized.</p>

<p>@return [String] The password component, normalized.</p>
            

            
            <div class="method-source-code" id="normalized_password-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 856</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalized_password</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_password</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_scheme</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/https?/</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span>
        (<span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span> <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span>)
      <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_component</span>(
        <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span>.<span class="ruby-identifier">strip</span>,
        <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>
      )
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalized_password-source -->
            
          </div>

          

          
        </div><!-- normalized_password-method -->

      
        <div id="normalized_path-method" class="method-detail ">
          <a name="method-i-normalized_path"></a>

          
          <div class="method-heading">
            <span class="method-name">normalized_path</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The path component for this <a href="URI.html">URI</a>, normalized.</p>

<p>@return [String] The path component, normalized.</p>
            

            
            <div class="method-source-code" id="normalized_path-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1266</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalized_path</span>
  <span class="ruby-ivar">@normalized_path</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">path</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-constant">NORMPATH</span>
      <span class="ruby-comment"># Relative paths with colons in the first segment are ambiguous.</span>
      <span class="ruby-identifier">path</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-string">&quot;:&quot;</span>, <span class="ruby-string">&quot;%2F&quot;</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment"># String#split(delimeter, -1) uses the more strict splitting behavior</span>
    <span class="ruby-comment"># found by default in Python.</span>
    <span class="ruby-identifier">result</span> = (<span class="ruby-identifier">path</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">split</span>(<span class="ruby-constant">SLASH</span>, <span class="ruby-value">-1</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">segment</span><span class="ruby-operator">|</span>
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_component</span>(
        <span class="ruby-identifier">segment</span>,
        <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">PCHAR</span>
      )
    <span class="ruby-keyword">end</span>).<span class="ruby-identifier">join</span>(<span class="ruby-constant">SLASH</span>)

    <span class="ruby-identifier">result</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_path</span>(<span class="ruby-identifier">result</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span>
        [<span class="ruby-string">&quot;http&quot;</span>, <span class="ruby-string">&quot;https&quot;</span>, <span class="ruby-string">&quot;ftp&quot;</span>, <span class="ruby-string">&quot;tftp&quot;</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_scheme</span>)
      <span class="ruby-identifier">result</span> = <span class="ruby-constant">SLASH</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">result</span>
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalized_path-source -->
            
          </div>

          

          
        </div><!-- normalized_path-method -->

      
        <div id="normalized_port-method" class="method-detail ">
          <a name="method-i-normalized_port"></a>

          
          <div class="method-heading">
            <span class="method-name">normalized_port</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The port component for this <a href="URI.html">URI</a>, normalized.</p>

<p>@return [Integer] The port component, normalized.</p>
            

            
            <div class="method-source-code" id="normalized_port-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1139</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalized_port</span>
  <span class="ruby-keyword">if</span> <span class="ruby-constant">URI</span>.<span class="ruby-identifier">port_mapping</span>[<span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_scheme</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">port</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">port</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalized_port-source -->
            
          </div>

          

          
        </div><!-- normalized_port-method -->

      
        <div id="normalized_query-method" class="method-detail ">
          <a name="method-i-normalized_query"></a>

          
          <div class="method-heading">
            <span class="method-name">normalized_query</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The query component for this <a href="URI.html">URI</a>, normalized.</p>

<p>@return [String] The query component, normalized.</p>
            

            
            <div class="method-source-code" id="normalized_query-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1341</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalized_query</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_query</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;&amp;&quot;</span>, <span class="ruby-value">-1</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span><span class="ruby-operator">|</span>
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_component</span>(
        <span class="ruby-identifier">pair</span>,
        <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">QUERY</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-string">&quot;\\&amp;&quot;</span>, <span class="ruby-string">&quot;&quot;</span>)
      )
    <span class="ruby-keyword">end</span>).<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;&amp;&quot;</span>)
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalized_query-source -->
            
          </div>

          

          
        </div><!-- normalized_query-method -->

      
        <div id="normalized_scheme-method" class="method-detail ">
          <a name="method-i-normalized_scheme"></a>

          
          <div class="method-heading">
            <span class="method-name">normalized_scheme</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The scheme component for this <a href="URI.html">URI</a>, normalized.</p>

<p>@return [String] The scheme component, normalized.</p>
            

            
            <div class="method-source-code" id="normalized_scheme-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 753</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalized_scheme</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_scheme</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^\s*ssh\+svn\s*$/</span>
      <span class="ruby-string">&quot;svn+ssh&quot;</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_component</span>(
        <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">downcase</span>,
        <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">SCHEME</span>
      )
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalized_scheme-source -->
            
          </div>

          

          
        </div><!-- normalized_scheme-method -->

      
        <div id="normalized_site-method" class="method-detail ">
          <a name="method-i-normalized_site"></a>

          
          <div class="method-heading">
            <span class="method-name">normalized_site</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The normalized combination of components that represent a site. Combines
the scheme, user, password, host, and port components. Primarily useful for
HTTP and HTTPS.</p>

<p>For example, <tt>&quot;http://example.com/path?query&quot;</tt> would have
a <tt>site</tt> value of <tt>&quot;http://example.com&quot;</tt>.</p>

<p>@return [String] The normalized components that identify a site.</p>
            

            
            <div class="method-source-code" id="normalized_site-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1218</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalized_site</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">site</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_site</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">site_string</span> = <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_scheme</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">site_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{self.normalized_scheme}:&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_authority</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">site_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;//#{self.normalized_authority}&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">site_string</span>
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalized_site-source -->
            
          </div>

          

          
        </div><!-- normalized_site-method -->

      
        <div id="normalized_user-method" class="method-detail ">
          <a name="method-i-normalized_user"></a>

          
          <div class="method-heading">
            <span class="method-name">normalized_user</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The user component for this <a href="URI.html">URI</a>, normalized.</p>

<p>@return [String] The user component, normalized.</p>
            

            
            <div class="method-source-code" id="normalized_user-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 803</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalized_user</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_user</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">normalized_scheme</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/https?/</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span>
        (<span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span> <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span>)
      <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_component</span>(
        <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span>.<span class="ruby-identifier">strip</span>,
        <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>
      )
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalized_user-source -->
            
          </div>

          

          
        </div><!-- normalized_user-method -->

      
        <div id="normalized_userinfo-method" class="method-detail ">
          <a name="method-i-normalized_userinfo"></a>

          
          <div class="method-heading">
            <span class="method-name">normalized_userinfo</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The userinfo component for this <a href="URI.html">URI</a>, normalized.</p>

<p>@return [String] The userinfo component, normalized.</p>
            

            
            <div class="method-source-code" id="normalized_userinfo-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 920</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalized_userinfo</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">userinfo</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_userinfo</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">current_user</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_user</span>
    <span class="ruby-identifier">current_password</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_password</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">current_user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">current_password</span>
      <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">current_user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">current_password</span>
      <span class="ruby-node">&quot;#{current_user}:#{current_password}&quot;</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">current_user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">current_password</span>
      <span class="ruby-node">&quot;#{current_user}&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- normalized_userinfo-source -->
            
          </div>

          

          
        </div><!-- normalized_userinfo-method -->

      
        <div id="omit-method" class="method-detail ">
          <a name="method-i-omit"></a>

          
          <div class="method-heading">
            <span class="method-name">omit</span><span
              class="method-args">(*components)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Omits components from a <a href="URI.html">URI</a>.</p>

<p>@param [Symbol] *components The components to be omitted.</p>

<p>@return [Addressable::URI] The <a href="URI.html">URI</a> with components
omitted.</p>

<p>@example</p>

<pre>uri = Addressable::URI.parse(&quot;http://example.com/path?query&quot;)
#=&gt; #&lt;Addressable::URI:0xcc5e7a URI:http://example.com/path?query&gt;
uri.omit(:scheme, :authority)
#=&gt; #&lt;Addressable::URI:0xcc4d86 URI:/path?query&gt;</pre>
            

            
            <div class="method-source-code" id="omit-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 2055</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">omit</span>(*<span class="ruby-identifier">components</span>)
  <span class="ruby-identifier">invalid_components</span> = <span class="ruby-identifier">components</span> <span class="ruby-operator">-</span> [
    <span class="ruby-value">:scheme</span>, <span class="ruby-value">:user</span>, <span class="ruby-value">:password</span>, <span class="ruby-value">:userinfo</span>, <span class="ruby-value">:host</span>, <span class="ruby-value">:port</span>, <span class="ruby-value">:authority</span>,
    <span class="ruby-value">:path</span>, <span class="ruby-value">:query</span>, <span class="ruby-value">:fragment</span>
  ]
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">invalid_components</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
      <span class="ruby-node">&quot;Invalid component names: #{invalid_components.inspect}.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">duplicated_uri</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">duplicated_uri</span>.<span class="ruby-identifier">defer_validation</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">components</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">component</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">duplicated_uri</span>.<span class="ruby-identifier">send</span>((<span class="ruby-identifier">component</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;=&quot;</span>).<span class="ruby-identifier">to_sym</span>, <span class="ruby-keyword">nil</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">duplicated_uri</span>.<span class="ruby-identifier">user</span> = <span class="ruby-identifier">duplicated_uri</span>.<span class="ruby-identifier">normalized_user</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">duplicated_uri</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- omit-source -->
            
          </div>

          

          
        </div><!-- omit-method -->

      
        <div id="omit-21-method" class="method-detail ">
          <a name="method-i-omit-21"></a>

          
          <div class="method-heading">
            <span class="method-name">omit!</span><span
              class="method-args">(*components)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Destructive form of omit.</p>

<p>@param [Symbol] *components The components to be omitted.</p>

<p>@return [Addressable::URI] The <a href="URI.html">URI</a> with components
omitted.</p>

<p>@see <a href="URI.html#method-i-omit">Addressable::URI#omit</a></p>
            

            
            <div class="method-source-code" id="omit-21-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 2082</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">omit!</span>(*<span class="ruby-identifier">components</span>)
  <span class="ruby-identifier">replace_self</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">omit</span>(*<span class="ruby-identifier">components</span>))
<span class="ruby-keyword">end</span></pre>
            </div><!-- omit-21-source -->
            
          </div>

          

          
        </div><!-- omit-21-method -->

      
        <div id="origin-method" class="method-detail ">
          <a name="method-i-origin"></a>

          
          <div class="method-heading">
            <span class="method-name">origin</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The origin for this <a href="URI.html">URI</a>, serialized to ASCII, as per
draft-ietf-websec-origin-00, section 5.2.</p>

<p>@return [String] The serialized origin.</p>
            

            
            <div class="method-source-code" id="origin-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1096</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">origin</span>
  <span class="ruby-keyword">return</span> (<span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">authority</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalized_port</span>
      (
        <span class="ruby-node">&quot;#{self.normalized_scheme}://#{self.normalized_host}&quot;</span> <span class="ruby-operator">+</span>
        <span class="ruby-node">&quot;:#{self.normalized_port}&quot;</span>
      )
    <span class="ruby-keyword">else</span>
      <span class="ruby-node">&quot;#{self.normalized_scheme}://#{self.normalized_host}&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-string">&quot;null&quot;</span>
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- origin-source -->
            
          </div>

          

          
        </div><!-- origin-method -->

      
        <div id="password-method" class="method-detail ">
          <a name="method-i-password"></a>

          
          <div class="method-heading">
            <span class="method-name">password</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The password component for this <a href="URI.html">URI</a>.</p>

<p>@return [String] The password component.</p>
            

            
            <div class="method-source-code" id="password-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 848</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">password</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@password</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@password</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- password-source -->
            
          </div>

          

          
        </div><!-- password-method -->

      
        <div id="password-3D-method" class="method-detail ">
          <a name="method-i-password-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">password=</span><span
              class="method-args">(new_password)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the password component for this <a href="URI.html">URI</a>.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>] new_password
The new password component.</p>
            

            
            <div class="method-source-code" id="password-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 874</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">password=</span>(<span class="ruby-identifier">new_password</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_password</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_password</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_password.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@password</span> = <span class="ruby-identifier">new_password</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">new_password</span>.<span class="ruby-identifier">to_str</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># You can't have a nil user with a non-nil password</span>
  <span class="ruby-ivar">@password</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@user</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@password</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@user</span> = <span class="ruby-constant">EMPTYSTR</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Reset dependant values</span>
  <span class="ruby-ivar">@userinfo</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@normalized_userinfo</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@authority</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@normalized_password</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Ensure we haven't created an invalid URI</span>
  <span class="ruby-identifier">validate</span>()
<span class="ruby-keyword">end</span></pre>
            </div><!-- password-3D-source -->
            
          </div>

          

          
        </div><!-- password-3D-method -->

      
        <div id="path-method" class="method-detail ">
          <a name="method-i-path"></a>

          
          <div class="method-heading">
            <span class="method-name">path</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The path component for this <a href="URI.html">URI</a>.</p>

<p>@return [String] The path component.</p>
            

            
            <div class="method-source-code" id="path-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1257</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">path</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@path</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@path</span> <span class="ruby-operator">:</span> <span class="ruby-constant">EMPTYSTR</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- path-source -->
            
          </div>

          

          
        </div><!-- path-method -->

      
        <div id="path-3D-method" class="method-detail ">
          <a name="method-i-path-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">path=</span><span
              class="method-args">(new_path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the path component for this <a href="URI.html">URI</a>.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>] new_path The
new path component.</p>
            

            
            <div class="method-source-code" id="path-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1295</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">path=</span>(<span class="ruby-identifier">new_path</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_path</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_path</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_path.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@path</span> = (<span class="ruby-identifier">new_path</span> <span class="ruby-operator">||</span> <span class="ruby-constant">EMPTYSTR</span>).<span class="ruby-identifier">to_str</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@path</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@path</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">0</span>] <span class="ruby-operator">!=</span> <span class="ruby-constant">SLASH</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">host</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@path</span> = <span class="ruby-node">&quot;/#{@path}&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Reset dependant values</span>
  <span class="ruby-ivar">@normalized_path</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- path-3D-source -->
            
          </div>

          

          
        </div><!-- path-3D-method -->

      
        <div id="port-method" class="method-detail ">
          <a name="method-i-port"></a>

          
          <div class="method-heading">
            <span class="method-name">port</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The port component for this <a href="URI.html">URI</a>. This is the port
number actually given in the <a href="URI.html">URI</a>. This does not
infer port numbers from default values.</p>

<p>@return [Integer] The port component.</p>
            

            
            <div class="method-source-code" id="port-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1131</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">port</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@port</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@port</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- port-source -->
            
          </div>

          

          
        </div><!-- port-method -->

      
        <div id="port-3D-method" class="method-detail ">
          <a name="method-i-port-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">port=</span><span
              class="method-args">(new_port)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the port component for this <a href="URI.html">URI</a>.</p>

<p>@param [String, Integer, <a href="URI.html#method-i-to_s">to_s</a>]
new_port The new port component.</p>
            

            
            <div class="method-source-code" id="port-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1151</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">port=</span>(<span class="ruby-identifier">new_port</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_port</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">new_port</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">new_port</span> = <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">new_port</span>.<span class="ruby-identifier">to_str</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_port</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">new_port</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^\d+$/</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidURIError</span>,
      <span class="ruby-node">&quot;Invalid port number: #{new_port.inspect}&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@port</span> = <span class="ruby-identifier">new_port</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-ivar">@port</span> = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@port</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>

  <span class="ruby-comment"># Reset dependant values</span>
  <span class="ruby-ivar">@authority</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@normalized_port</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Ensure we haven't created an invalid URI</span>
  <span class="ruby-identifier">validate</span>()
<span class="ruby-keyword">end</span></pre>
            </div><!-- port-3D-source -->
            
          </div>

          

          
        </div><!-- port-3D-method -->

      
        <div id="query-method" class="method-detail ">
          <a name="method-i-query"></a>

          
          <div class="method-heading">
            <span class="method-name">query</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The query component for this <a href="URI.html">URI</a>.</p>

<p>@return [String] The query component.</p>
            

            
            <div class="method-source-code" id="query-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1333</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">query</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@query</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@query</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- query-source -->
            
          </div>

          

          
        </div><!-- query-method -->

      
        <div id="query-3D-method" class="method-detail ">
          <a name="method-i-query-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">query=</span><span
              class="method-args">(new_query)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the query component for this <a href="URI.html">URI</a>.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>] new_query
The new query component.</p>
            

            
            <div class="method-source-code" id="query-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1356</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">query=</span>(<span class="ruby-identifier">new_query</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_query</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_query</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_query.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@query</span> = <span class="ruby-identifier">new_query</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">new_query</span>.<span class="ruby-identifier">to_str</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Reset dependant values</span>
  <span class="ruby-ivar">@normalized_query</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- query-3D-source -->
            
          </div>

          

          
        </div><!-- query-3D-method -->

      
        <div id="query_values-method" class="method-detail ">
          <a name="method-i-query_values"></a>

          
          <div class="method-heading">
            <span class="method-name">query_values</span><span
              class="method-args">(options={})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Converts the query component to a Hash value.</p>

<p>@option [Symbol] notation</p>

<pre>May be one of &lt;code&gt;:flat&lt;/code&gt;, &lt;code&gt;:dot&lt;/code&gt;, or
&lt;code&gt;:subscript&lt;/code&gt;. The &lt;code&gt;:dot&lt;/code&gt; notation is not
supported for assignment. Default value is &lt;code&gt;:subscript&lt;/code&gt;.</pre>

<p>@return [Hash, Array] The query string parsed as a Hash or Array object.</p>

<p>@example</p>

<pre>Addressable::URI.parse(&quot;?one=1&amp;two=2&amp;three=3&quot;).query_values
#=&gt; {&quot;one&quot; =&gt; &quot;1&quot;, &quot;two&quot; =&gt; &quot;2&quot;, &quot;three&quot; =&gt; &quot;3&quot;}
Addressable::URI.parse(&quot;?one[two][three]=four&quot;).query_values
#=&gt; {&quot;one&quot; =&gt; {&quot;two&quot; =&gt; {&quot;three&quot; =&gt; &quot;four&quot;}}}
Addressable::URI.parse(&quot;?one.two.three=four&quot;).query_values(
  :notation =&gt; :dot
)
#=&gt; {&quot;one&quot; =&gt; {&quot;two&quot; =&gt; {&quot;three&quot; =&gt; &quot;four&quot;}}}
Addressable::URI.parse(&quot;?one[two][three]=four&quot;).query_values(
  :notation =&gt; :flat
)
#=&gt; {&quot;one[two][three]&quot; =&gt; &quot;four&quot;}
Addressable::URI.parse(&quot;?one.two.three=four&quot;).query_values(
  :notation =&gt; :flat
)
#=&gt; {&quot;one.two.three&quot; =&gt; &quot;four&quot;}
Addressable::URI.parse(
  &quot;?one[two][three][]=four&amp;one[two][three][]=five&quot;
).query_values
#=&gt; {&quot;one&quot; =&gt; {&quot;two&quot; =&gt; {&quot;three&quot; =&gt; [&quot;four&quot;, &quot;five&quot;]}}}
Addressable::URI.parse(
  &quot;?one=two&amp;one=three&quot;).query_values(:notation =&gt; :flat_array)
#=&gt; [['one', 'two'], ['one', 'three']]</pre>
            

            
            <div class="method-source-code" id="query_values-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1402</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">query_values</span>(<span class="ruby-identifier">options</span>={})
  <span class="ruby-identifier">defaults</span> = {<span class="ruby-value">:notation</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:subscript</span>}
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">defaults</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span>[<span class="ruby-value">:flat</span>, <span class="ruby-value">:dot</span>, <span class="ruby-value">:subscript</span>, <span class="ruby-value">:flat_array</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>])
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
      <span class="ruby-string">&quot;Invalid notation. Must be one of: &quot;</span> <span class="ruby-operator">+</span>
      <span class="ruby-string">&quot;[:flat, :dot, :subscript, :flat_array].&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">dehash</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Hash</span>)
        <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">dehash</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">value</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">hash</span> <span class="ruby-operator">!=</span> {} <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">all?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^\d+$/</span> }
      <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">inject</span>([]) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">accu</span>, (<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
        <span class="ruby-identifier">accu</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span>; <span class="ruby-identifier">accu</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">hash</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">empty_accumulator</span> = <span class="ruby-value">:flat_array</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>] <span class="ruby-operator">?</span> [] <span class="ruby-operator">:</span> {}
  <span class="ruby-keyword">return</span> ((<span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;&amp;&quot;</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;=&quot;</span>, <span class="ruby-value">2</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">pair</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">pair</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-keyword">end</span>).<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-identifier">empty_accumulator</span>.<span class="ruby-identifier">dup</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">accumulator</span>, (<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
    <span class="ruby-identifier">value</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">key</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">key</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">true</span>
      <span class="ruby-identifier">value</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">value</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/\+/</span>, <span class="ruby-string">&quot; &quot;</span>))
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:flat</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">accumulator</span>[<span class="ruby-identifier">key</span>]
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;Key was repeated: #{key.inspect}&quot;</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">accumulator</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:flat_array</span>
      <span class="ruby-identifier">accumulator</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>]
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:dot</span>
        <span class="ruby-identifier">array_value</span> = <span class="ruby-keyword">false</span>
        <span class="ruby-identifier">subkeys</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;.&quot;</span>)
      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:subscript</span>
        <span class="ruby-identifier">array_value</span> = <span class="ruby-operator">!</span><span class="ruby-operator">!</span>(<span class="ruby-identifier">key</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\[\]$/</span>)
        <span class="ruby-identifier">subkeys</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">/[\[\]]+/</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">current_hash</span> = <span class="ruby-identifier">accumulator</span>
      <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span><span class="ruby-operator">...</span>(<span class="ruby-identifier">subkeys</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>)
        <span class="ruby-identifier">subkey</span> = <span class="ruby-identifier">subkeys</span>[<span class="ruby-identifier">i</span>]
        <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkey</span>] = {} <span class="ruby-keyword">unless</span> <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkey</span>]
        <span class="ruby-identifier">current_hash</span> = <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkey</span>]
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">array_value</span>
        <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkeys</span>.<span class="ruby-identifier">last</span>] = [] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkeys</span>.<span class="ruby-identifier">last</span>]
        <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkeys</span>.<span class="ruby-identifier">last</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkeys</span>.<span class="ruby-identifier">last</span>] = <span class="ruby-identifier">value</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">accumulator</span>
  <span class="ruby-keyword">end</span>).<span class="ruby-identifier">inject</span>(<span class="ruby-identifier">empty_accumulator</span>.<span class="ruby-identifier">dup</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">accumulator</span>, (<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:flat_array</span>
      <span class="ruby-identifier">accumulator</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>]
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">accumulator</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">dehash</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">value</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">value</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">accumulator</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- query_values-source -->
            
          </div>

          

          
        </div><!-- query_values-method -->

      
        <div id="query_values-3D-method" class="method-detail ">
          <a name="method-i-query_values-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">query_values=</span><span
              class="method-args">(new_query_values)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the query component for this <a href="URI.html">URI</a> from a Hash
object. This method produces a query string using the :subscript notation.
An empty Hash will result in a nil query.</p>

<p>@param [Hash, <a href="URI.html#method-i-to_hash">to_hash</a>, Array]
new_query_values The new query values.</p>
            

            
            <div class="method-source-code" id="query_values-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1479</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">query_values=</span>(<span class="ruby-identifier">new_query_values</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_query_values</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_query_values</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_query_values</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_hash</span>)
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>,
        <span class="ruby-node">&quot;Can't convert #{new_query_values.class} into Hash.&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">new_query_values</span> = <span class="ruby-identifier">new_query_values</span>.<span class="ruby-identifier">to_hash</span>
    <span class="ruby-identifier">new_query_values</span> = <span class="ruby-identifier">new_query_values</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">key</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Symbol</span>)
      [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>]
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment"># Useful default for OAuth and caching.</span>
    <span class="ruby-comment"># Only to be used for non-Array inputs. Arrays should preserve order.</span>
    <span class="ruby-identifier">new_query_values</span>.<span class="ruby-identifier">sort!</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># new_query_values have form [['key1', 'value1'], ['key2', 'value2']]</span>

  <span class="ruby-comment"># Algorithm shamelessly stolen from Julien Genestoux, slightly modified</span>
  <span class="ruby-identifier">buffer</span> = <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-identifier">stack</span> = []
  <span class="ruby-identifier">e</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">component</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">component</span> = <span class="ruby-identifier">component</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">component</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Symbol</span>)
    <span class="ruby-constant">URI</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">component</span>, <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">new_query_values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Hash</span>)
      <span class="ruby-identifier">stack</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>]
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Array</span>)
      <span class="ruby-identifier">stack</span> <span class="ruby-operator">&lt;&lt;</span> [
        <span class="ruby-identifier">key</span>,
        <span class="ruby-identifier">value</span>.<span class="ruby-identifier">inject</span>({}) { <span class="ruby-operator">|</span><span class="ruby-identifier">accu</span>, <span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">accu</span>[<span class="ruby-identifier">accu</span>.<span class="ruby-identifier">size</span>.<span class="ruby-identifier">to_s</span>] = <span class="ruby-identifier">x</span>; <span class="ruby-identifier">accu</span> }
      ]
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>
      <span class="ruby-identifier">buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{e.call(key)}&amp;&quot;</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{e.call(key)}=#{e.call(value)}&amp;&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span>(<span class="ruby-identifier">parent</span>, <span class="ruby-identifier">hash</span>)<span class="ruby-operator">|</span>
    (<span class="ruby-identifier">hash</span>.<span class="ruby-identifier">sort_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span> }).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Hash</span>)
        <span class="ruby-identifier">stack</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-node">&quot;#{parent}[#{key}]&quot;</span>, <span class="ruby-identifier">value</span>]
      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>
        <span class="ruby-identifier">buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{parent}[#{e.call(key)}]&amp;&quot;</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{parent}[#{e.call(key)}]=#{e.call(value)}&amp;&quot;</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span> = <span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">chop</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- query_values-3D-source -->
            
          </div>

          

          
        </div><!-- query_values-3D-method -->

      
        <div id="relative-3F-method" class="method-detail ">
          <a name="method-i-relative-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">relative?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Determines if the <a href="URI.html">URI</a> is relative.</p>

<p>@return [TrueClass, FalseClass]</p>

<pre>&lt;code&gt;true&lt;/code&gt; if the URI is relative. &lt;code&gt;false&lt;/code&gt;
otherwise.</pre>
            

            
            <div class="method-source-code" id="relative-3F-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1634</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">relative?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">nil?</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- relative-3F-source -->
            
          </div>

          

          
        </div><!-- relative-3F-method -->

      
        <div id="request_uri-method" class="method-detail ">
          <a name="method-i-request_uri"></a>

          
          <div class="method-heading">
            <span class="method-name">request_uri</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The HTTP request <a href="URI.html">URI</a> for this <a
href="URI.html">URI</a>.  This is the path and the query string.</p>

<p>@return [String] The request <a href="URI.html">URI</a> required for an
HTTP request.</p>
            

            
            <div class="method-source-code" id="request_uri-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1541</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">request_uri</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">absolute?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp">/^https?$/</span>
  <span class="ruby-keyword">return</span> (
    (<span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">:</span> <span class="ruby-constant">SLASH</span>) <span class="ruby-operator">+</span>
    (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">?</span> <span class="ruby-node">&quot;?#{self.query}&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-constant">EMPTYSTR</span>)
  )
<span class="ruby-keyword">end</span></pre>
            </div><!-- request_uri-source -->
            
          </div>

          

          
        </div><!-- request_uri-method -->

      
        <div id="request_uri-3D-method" class="method-detail ">
          <a name="method-i-request_uri-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">request_uri=</span><span
              class="method-args">(new_request_uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the HTTP request <a href="URI.html">URI</a> for this <a
href="URI.html">URI</a>.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>]
new_request_uri The new HTTP request <a href="URI.html">URI</a>.</p>
            

            
            <div class="method-source-code" id="request_uri-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1553</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">request_uri=</span>(<span class="ruby-identifier">new_request_uri</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_request_uri</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_request_uri.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">absolute?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp">/^https?$/</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidURIError</span>,
      <span class="ruby-string">&quot;Cannot set an HTTP request URI for a non-HTTP URI.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">new_request_uri</span> = <span class="ruby-identifier">new_request_uri</span>.<span class="ruby-identifier">to_str</span>
  <span class="ruby-identifier">path_component</span> = <span class="ruby-identifier">new_request_uri</span>[<span class="ruby-regexp">/^([^\?]*)\?(?:.*)$/</span>, <span class="ruby-value">1</span>]
  <span class="ruby-identifier">query_component</span> = <span class="ruby-identifier">new_request_uri</span>[<span class="ruby-regexp">/^(?:[^\?]*)\?(.*)$/</span>, <span class="ruby-value">1</span>]
  <span class="ruby-identifier">path_component</span> = <span class="ruby-identifier">path_component</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">path_component</span> = (<span class="ruby-operator">!</span><span class="ruby-identifier">path_component</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">path_component</span> <span class="ruby-operator">:</span> <span class="ruby-constant">SLASH</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span> = <span class="ruby-identifier">path_component</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span> = <span class="ruby-identifier">query_component</span>

  <span class="ruby-comment"># Reset dependant values</span>
  <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- request_uri-3D-source -->
            
          </div>

          

          
        </div><!-- request_uri-3D-method -->

      
        <div id="route_from-method" class="method-detail ">
          <a name="method-i-route_from"></a>

          
          <div class="method-heading">
            <span class="method-name">route_from</span><span
              class="method-args">(uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the shortest normalized relative form of this <a
href="URI.html">URI</a> that uses the supplied <a href="URI.html">URI</a>
as a base for resolution. Returns an absolute <a href="URI.html">URI</a> if
necessary. This is effectively the opposite of <tt>route_to</tt>.</p>

<p>@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">to_str</a>] uri The <a
href="URI.html">URI</a> to route from.</p>

<p>@return [Addressable::URI]</p>

<pre>The normalized relative URI that is equivalent to the original URI.</pre>
            

            
            <div class="method-source-code" id="route_from-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1850</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">route_from</span>(<span class="ruby-identifier">uri</span>)
  <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>).<span class="ruby-identifier">normalize</span>
  <span class="ruby-identifier">normalized_self</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">normalize</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">relative?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;Expected absolute URI, got: #{self.to_s}&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">relative?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;Expected absolute URI, got: #{uri.to_s}&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">normalized_self</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>
    <span class="ruby-keyword">return</span> <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-node">&quot;##{normalized_self.fragment}&quot;</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">components</span> = <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">to_hash</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span>
    <span class="ruby-identifier">components</span>[<span class="ruby-value">:scheme</span>] = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">authority</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">authority</span>
      <span class="ruby-identifier">components</span>[<span class="ruby-value">:user</span>] = <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">components</span>[<span class="ruby-value">:password</span>] = <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">components</span>[<span class="ruby-value">:host</span>] = <span class="ruby-keyword">nil</span>
      <span class="ruby-identifier">components</span>[<span class="ruby-value">:port</span>] = <span class="ruby-keyword">nil</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>
        <span class="ruby-identifier">components</span>[<span class="ruby-value">:path</span>] = <span class="ruby-keyword">nil</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span>
          <span class="ruby-identifier">components</span>[<span class="ruby-value">:query</span>] = <span class="ruby-keyword">nil</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">SLASH</span>
          <span class="ruby-identifier">components</span>[<span class="ruby-value">:path</span>].<span class="ruby-identifier">gsub!</span>(
            <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;^&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>)), <span class="ruby-constant">EMPTYSTR</span>)
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># Avoid network-path references.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:host</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-identifier">components</span>[<span class="ruby-value">:scheme</span>] = <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">scheme</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(
    <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:scheme</span>],
    <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:user</span>],
    <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:password</span>],
    <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:host</span>],
    <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:port</span>],
    <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:path</span>],
    <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:query</span>],
    <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:fragment</span>]
  )
<span class="ruby-keyword">end</span></pre>
            </div><!-- route_from-source -->
            
          </div>

          

          
        </div><!-- route_from-method -->

      
        <div id="route_to-method" class="method-detail ">
          <a name="method-i-route_to"></a>

          
          <div class="method-heading">
            <span class="method-name">route_to</span><span
              class="method-args">(uri)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the shortest normalized relative form of the supplied <a
href="URI.html">URI</a> that uses this <a href="URI.html">URI</a> as a base
for resolution. Returns an absolute <a href="URI.html">URI</a> if
necessary. This is effectively the opposite of <tt>route_from</tt>.</p>

<p>@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">to_str</a>] uri The <a
href="URI.html">URI</a> to route to.</p>

<p>@return [Addressable::URI]</p>

<pre>The normalized relative URI that is equivalent to the supplied URI.</pre>
            

            
            <div class="method-source-code" id="route_to-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1908</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">route_to</span>(<span class="ruby-identifier">uri</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>).<span class="ruby-identifier">route_from</span>(<span class="ruby-keyword">self</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- route_to-source -->
            
          </div>

          

          
        </div><!-- route_to-method -->

      
        <div id="scheme-method" class="method-detail ">
          <a name="method-i-scheme"></a>

          
          <div class="method-heading">
            <span class="method-name">scheme</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The scheme component for this <a href="URI.html">URI</a>.</p>

<p>@return [String] The scheme component.</p>
            

            
            <div class="method-source-code" id="scheme-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 745</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">scheme</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@scheme</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@scheme</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- scheme-source -->
            
          </div>

          

          
        </div><!-- scheme-method -->

      
        <div id="scheme-3D-method" class="method-detail ">
          <a name="method-i-scheme-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">scheme=</span><span
              class="method-args">(new_scheme)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the scheme component for this <a href="URI.html">URI</a>.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>] new_scheme
The new scheme component.</p>
            

            
            <div class="method-source-code" id="scheme-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 770</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">scheme=</span>(<span class="ruby-identifier">new_scheme</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_scheme</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_scheme</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_scheme.class} into String.&quot;</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">new_scheme</span>
    <span class="ruby-identifier">new_scheme</span> = <span class="ruby-identifier">new_scheme</span>.<span class="ruby-identifier">to_str</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_scheme</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">new_scheme</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp">/[a-z][a-z0-9\.\+\-]*/</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidURIError</span>, <span class="ruby-string">&quot;Invalid scheme format.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@scheme</span> = <span class="ruby-identifier">new_scheme</span>
  <span class="ruby-ivar">@scheme</span> = <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@scheme</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span>

  <span class="ruby-comment"># Reset dependant values</span>
  <span class="ruby-ivar">@normalized_scheme</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Ensure we haven't created an invalid URI</span>
  <span class="ruby-identifier">validate</span>()
<span class="ruby-keyword">end</span></pre>
            </div><!-- scheme-3D-source -->
            
          </div>

          

          
        </div><!-- scheme-3D-method -->

      
        <div id="site-method" class="method-detail ">
          <a name="method-i-site"></a>

          
          <div class="method-heading">
            <span class="method-name">site</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The combination of components that represent a site. Combines the scheme,
user, password, host, and port components. Primarily useful for HTTP and
HTTPS.</p>

<p>For example, <tt>&quot;http://example.com/path?query&quot;</tt> would have
a <tt>site</tt> value of <tt>&quot;http://example.com&quot;</tt>.</p>

<p>@return [String] The components that identify a site.</p>
            

            
            <div class="method-source-code" id="site-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1200</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">site</span>
  (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">authority</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@site</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">site_string</span> = <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-identifier">site_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{self.scheme}:&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-identifier">site_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;//#{self.authority}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">authority</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-identifier">site_string</span>
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- site-source -->
            
          </div>

          

          
        </div><!-- site-method -->

      
        <div id="site-3D-method" class="method-detail ">
          <a name="method-i-site-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">site=</span><span
              class="method-args">(new_site)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the site value for this <a href="URI.html">URI</a>.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>] new_site The
new site value.</p>
            

            
            <div class="method-source-code" id="site-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 1235</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">site=</span>(<span class="ruby-identifier">new_site</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_site</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_site</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_site.class} into String.&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">new_site</span> = <span class="ruby-identifier">new_site</span>.<span class="ruby-identifier">to_str</span>
    <span class="ruby-comment"># These two regular expressions derived from the primary parsing</span>
    <span class="ruby-comment"># expression</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> = <span class="ruby-identifier">new_site</span>[<span class="ruby-node">/^(?:([^:\/?#]+):)?(?:\/\/(?:[^\/?#]*))?$/</span>, <span class="ruby-value">1</span>]
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">authority</span> = <span class="ruby-identifier">new_site</span>[
      <span class="ruby-node">/^(?:(?:[^:\/?#]+):)?(?:\/\/([^\/?#]*))?$/</span>, <span class="ruby-value">1</span>
    ]
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">authority</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- site-3D-source -->
            
          </div>

          

          
        </div><!-- site-3D-method -->

      
        <div id="to_hash-method" class="method-detail ">
          <a name="method-i-to_hash"></a>

          
          <div class="method-heading">
            <span class="method-name">to_hash</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns a Hash of the <a href="URI.html">URI</a> components.</p>

<p>@return [Hash] The <a href="URI.html">URI</a> as a <tt>Hash</tt> of
components.</p>
            

            
            <div class="method-source-code" id="to_hash-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 2118</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_hash</span>
  <span class="ruby-keyword">return</span> {
    <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span>,
    <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span>,
    <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span>,
    <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">host</span>,
    <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">port</span>,
    <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>,
    <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span>,
    <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">fragment</span>
  }
<span class="ruby-keyword">end</span></pre>
            </div><!-- to_hash-source -->
            
          </div>

          

          
        </div><!-- to_hash-method -->

      
        <div id="to_s-method" class="method-detail ">
          <a name="method-i-to_s"></a>

          
          <div class="method-heading">
            <span class="method-name">to_s</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Converts the <a href="URI.html">URI</a> to a <tt>String</tt>.</p>

<p>@return [String] The URI’s <tt>String</tt> representation.</p>
            

            
            <div class="method-source-code" id="to_s-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 2090</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span>
      <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-constant">NORMPATH</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidURIError</span>,
      <span class="ruby-node">&quot;Cannot assemble URI string with ambiguous path: '#{self.path}'&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@uri_string</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">uri_string</span> = <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-identifier">uri_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{self.scheme}:&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-identifier">uri_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;//#{self.authority}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">authority</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-identifier">uri_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">uri_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;?#{self.query}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-identifier">uri_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;##{self.fragment}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">fragment</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">uri_string</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:force_encoding</span>)
      <span class="ruby-identifier">uri_string</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-constant">Encoding</span><span class="ruby-operator">::</span><span class="ruby-constant">UTF_8</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">uri_string</span>
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- to_s-source -->
            
          </div>

          
          <div class="aliases">
            Also aliased as: <a href="URI.html#method-i-to_str">to_str</a>
          </div>
          

          
        </div><!-- to_s-method -->

      
        <div id="to_str-method" class="method-detail method-alias">
          <a name="method-i-to_str"></a>

          
          <div class="method-heading">
            <span class="method-name">to_str</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>URI’s are glorified <tt>Strings</tt>. Allow implicit conversion.</p>
            

            
          </div>

          

          
          <div class="aliases">
            Alias for: <a href="URI.html#method-i-to_s">to_s</a>
          </div>
          
        </div><!-- to_str-method -->

      
        <div id="user-method" class="method-detail ">
          <a name="method-i-user"></a>

          
          <div class="method-heading">
            <span class="method-name">user</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The user component for this <a href="URI.html">URI</a>.</p>

<p>@return [String] The user component.</p>
            

            
            <div class="method-source-code" id="user-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 795</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">user</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@user</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@user</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- user-source -->
            
          </div>

          

          
        </div><!-- user-method -->

      
        <div id="user-3D-method" class="method-detail ">
          <a name="method-i-user-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">user=</span><span
              class="method-args">(new_user)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the user component for this <a href="URI.html">URI</a>.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>] new_user The
new user component.</p>
            

            
            <div class="method-source-code" id="user-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 821</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">user=</span>(<span class="ruby-identifier">new_user</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_user</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_user.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@user</span> = <span class="ruby-identifier">new_user</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">new_user</span>.<span class="ruby-identifier">to_str</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># You can't have a nil user with a non-nil password</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">password</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@user</span> = <span class="ruby-constant">EMPTYSTR</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Reset dependant values</span>
  <span class="ruby-ivar">@userinfo</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@normalized_userinfo</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@authority</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@normalized_user</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Ensure we haven't created an invalid URI</span>
  <span class="ruby-identifier">validate</span>()
<span class="ruby-keyword">end</span></pre>
            </div><!-- user-3D-source -->
            
          </div>

          

          
        </div><!-- user-3D-method -->

      
        <div id="userinfo-method" class="method-detail ">
          <a name="method-i-userinfo"></a>

          
          <div class="method-heading">
            <span class="method-name">userinfo</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>The userinfo component for this <a href="URI.html">URI</a>. Combines the
user and password components.</p>

<p>@return [String] The userinfo component.</p>
            

            
            <div class="method-source-code" id="userinfo-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 904</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">userinfo</span>
  <span class="ruby-identifier">current_user</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span>
  <span class="ruby-identifier">current_password</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span>
  (<span class="ruby-identifier">current_user</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">current_password</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@userinfo</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">current_password</span>
      <span class="ruby-node">&quot;#{current_user}:#{current_password}&quot;</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">current_user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">current_password</span>
      <span class="ruby-node">&quot;#{current_user}&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- userinfo-source -->
            
          </div>

          

          
        </div><!-- userinfo-method -->

      
        <div id="userinfo-3D-method" class="method-detail ">
          <a name="method-i-userinfo-3D"></a>

          
          <div class="method-heading">
            <span class="method-name">userinfo=</span><span
              class="method-args">(new_userinfo)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Sets the userinfo component for this <a href="URI.html">URI</a>.</p>

<p>@param [String, <a href="URI.html#method-i-to_str">to_str</a>] new_userinfo
The new userinfo component.</p>
            

            
            <div class="method-source-code" id="userinfo-3D-source">
<pre>
<span class="ruby-comment"># File lib/addressable/uri.rb, line 938</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">userinfo=</span>(<span class="ruby-identifier">new_userinfo</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_userinfo</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_userinfo</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_userinfo.class} into String.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">new_user</span>, <span class="ruby-identifier">new_password</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_userinfo</span>
    [
      <span class="ruby-identifier">new_userinfo</span>.<span class="ruby-identifier">to_str</span>.<span class="ruby-identifier">strip</span>[<span class="ruby-regexp">/^(.*):/</span>, <span class="ruby-value">1</span>],
      <span class="ruby-identifier">new_userinfo</span>.<span class="ruby-identifier">to_str</span>.<span class="ruby-identifier">strip</span>[<span class="ruby-regexp">/:(.*)$/</span>, <span class="ruby-value">1</span>]
    ]
  <span class="ruby-keyword">else</span>
    [<span class="ruby-keyword">nil</span>, <span class="ruby-keyword">nil</span>]
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Password assigned first to ensure validity in case of nil</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">password</span> = <span class="ruby-identifier">new_password</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">user</span> = <span class="ruby-identifier">new_user</span>

  <span class="ruby-comment"># Reset dependant values</span>
  <span class="ruby-ivar">@authority</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Ensure we haven't created an invalid URI</span>
  <span class="ruby-identifier">validate</span>()
<span class="ruby-keyword">end</span></pre>
            </div><!-- userinfo-3D-source -->
            
          </div>

          

          
        </div><!-- userinfo-3D-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

